<!DOCTYPE html>
<html lang="zh"><head><title>Openstack-Trainå®‰è£…</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Openstack-Trainå®‰è£…"/><meta property="og:description" content="åŸºç¡€ç¯å¢ƒå‡†å¤‡ èŠ‚ç‚¹è§„åˆ’ åç§°æè¿°ç®¡ç†IPï¼ˆè™šæ‹Ÿæœºï¼‰å†…éƒ¨IPé…ç½®ctl01æ§åˆ¶èŠ‚ç‚¹10.191.101.128/24192.168.80.128/242C2Gcompute01è®¡ç®—èŠ‚ç‚¹10.191.101.129/24192.168.80.129/242C4Gneutron01ç½‘ç»œèŠ‚ç‚¹10.191.101."/><meta property="og:image" content="https://chyuhung.github.io/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="åŸºç¡€ç¯å¢ƒå‡†å¤‡ èŠ‚ç‚¹è§„åˆ’ åç§°æè¿°ç®¡ç†IPï¼ˆè™šæ‹Ÿæœºï¼‰å†…éƒ¨IPé…ç½®ctl01æ§åˆ¶èŠ‚ç‚¹10.191.101.128/24192.168.80.128/242C2Gcompute01è®¡ç®—èŠ‚ç‚¹10.191.101.129/24192.168.80.129/242C4Gneutron01ç½‘ç»œèŠ‚ç‚¹10.191.101."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/Openstack-Trainå®‰è£…"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="..">ğŸª´ åäºŒä¸‡å…‰å¹´</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>æœç´¢</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="æœç´¢äº›ä»€ä¹ˆ" placeholder="æœç´¢äº›ä»€ä¹ˆ"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>æš—è‰²æ¨¡å¼</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>äº®è‰²æ¨¡å¼</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;åŸºç¡€æŠ€èƒ½&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;å®‰å…¨å’Œæƒé™ç®¡ç†&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;ç›‘æ§å’Œæ—¥å¿—ç®¡ç†&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹&quot;,&quot;collapsed&quot;:true}]"><h1>æ¢ç´¢</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–"><button class="folder-button"><span class="folder-title">äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–"><li><a href="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/docker" data-for="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/docker">docker</a></li><li><a href="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/k8s" data-for="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/k8s">k8s</a></li><li><a href="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/openstack" data-for="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/openstack">openstack</a></li><li><a href="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/Openstack-Trainå®‰è£…" data-for="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/Openstack-Trainå®‰è£…">Openstack-Trainå®‰è£…</a></li><li><a href="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–" data-for="äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–">äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="åŸºç¡€æŠ€èƒ½"><button class="folder-button"><span class="folder-title">åŸºç¡€æŠ€èƒ½</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="åŸºç¡€æŠ€èƒ½"><li><a href="../åŸºç¡€æŠ€èƒ½/go" data-for="åŸºç¡€æŠ€èƒ½/go">go</a></li><li><a href="../åŸºç¡€æŠ€èƒ½/python" data-for="åŸºç¡€æŠ€èƒ½/python">python</a></li><li><a href="../åŸºç¡€æŠ€èƒ½/shell" data-for="åŸºç¡€æŠ€èƒ½/shell">shell</a></li><li><a href="../åŸºç¡€æŠ€èƒ½/shellä¸‹è½½å‘½ä»¤" data-for="åŸºç¡€æŠ€èƒ½/shellä¸‹è½½å‘½ä»¤">shellä¸‹è½½å‘½ä»¤</a></li><li><a href="../åŸºç¡€æŠ€èƒ½/vue" data-for="åŸºç¡€æŠ€èƒ½/vue">vue</a></li><li><a href="../åŸºç¡€æŠ€èƒ½/åŸºç¡€æŠ€èƒ½" data-for="åŸºç¡€æŠ€èƒ½/åŸºç¡€æŠ€èƒ½">åŸºç¡€æŠ€èƒ½</a></li><li><a href="../åŸºç¡€æŠ€èƒ½/æœåŠ¡å™¨raidé…ç½®" data-for="åŸºç¡€æŠ€èƒ½/æœåŠ¡å™¨raidé…ç½®">æœåŠ¡å™¨raidé…ç½®</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="å®‰å…¨å’Œæƒé™ç®¡ç†"><button class="folder-button"><span class="folder-title">å®‰å…¨å’Œæƒé™ç®¡ç†</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="å®‰å…¨å’Œæƒé™ç®¡ç†"><li><a href="../å®‰å…¨å’Œæƒé™ç®¡ç†/sshå…å¯†ç™»å½•" data-for="å®‰å…¨å’Œæƒé™ç®¡ç†/sshå…å¯†ç™»å½•">sshå…å¯†ç™»å½•</a></li><li><a href="../å®‰å…¨å’Œæƒé™ç®¡ç†/å…¬é’¥ä¸ç§é’¥" data-for="å®‰å…¨å’Œæƒé™ç®¡ç†/å…¬é’¥ä¸ç§é’¥">å…¬é’¥ä¸ç§é’¥</a></li><li><a href="../å®‰å…¨å’Œæƒé™ç®¡ç†/å®‰å…¨å’Œæƒé™ç®¡ç†" data-for="å®‰å…¨å’Œæƒé™ç®¡ç†/å®‰å…¨å’Œæƒé™ç®¡ç†">å®‰å…¨å’Œæƒé™ç®¡ç†</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾"><button class="folder-button"><span class="folder-title">åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾"><li><a href="../åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾/åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾" data-for="åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾/åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾">åº”ç”¨éƒ¨ç½²å’Œå®¹ç¾</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–"><button class="folder-button"><span class="folder-title">æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–"><li><a href="../æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/linux-å‡ºé”™-task-xxxxx-634-blocked-for-more-than-120-seconds" data-for="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/linux-å‡ºé”™-task-xxxxx-634-blocked-for-more-than-120-seconds">linux å‡ºé”™ task xxxxx 634 blocked for more than 120 seconds</a></li><li><a href="../æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/mysql" data-for="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/mysql">mysql</a></li><li><a href="../æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/NTPæœåŠ¡é…ç½®" data-for="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/NTPæœåŠ¡é…ç½®">NTPæœåŠ¡é…ç½®</a></li><li><a href="../æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–" data-for="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–">æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–</a></li><li><a href="../æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/é¸¿è’™OSç³»ç»Ÿä¼˜åŒ–" data-for="æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–/é¸¿è’™OSç³»ç»Ÿä¼˜åŒ–">é¸¿è’™OSç³»ç»Ÿä¼˜åŒ–</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›"><button class="folder-button"><span class="folder-title">æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›"><li><a href="../æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›/æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›" data-for="æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›/æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›">æ–‡æ¡£å’Œæ²Ÿé€šèƒ½åŠ›</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="ç›‘æ§å’Œæ—¥å¿—ç®¡ç†"><button class="folder-button"><span class="folder-title">ç›‘æ§å’Œæ—¥å¿—ç®¡ç†</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="ç›‘æ§å’Œæ—¥å¿—ç®¡ç†"><li><a href="../ç›‘æ§å’Œæ—¥å¿—ç®¡ç†/ç›‘æ§å’Œæ—¥å¿—ç®¡ç†" data-for="ç›‘æ§å’Œæ—¥å¿—ç®¡ç†/ç›‘æ§å’Œæ—¥å¿—ç®¡ç†">ç›‘æ§å’Œæ—¥å¿—ç®¡ç†</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†"><button class="folder-button"><span class="folder-title">ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†"><li><a href="../ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/ceph" data-for="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/ceph">ceph</a></li><li><a href="../ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/keepalived" data-for="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/keepalived">keepalived</a></li><li><a href="../ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/mysql" data-for="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/mysql">mysql</a></li><li><a href="../ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/pgsql" data-for="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/pgsql">pgsql</a></li><li><a href="../ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†" data-for="ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†/ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†">ç½‘ç»œå’Œå­˜å‚¨ç®¡ç†</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹"><button class="folder-button"><span class="folder-title">è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹"><li><a href="../è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/ansible" data-for="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/ansible">ansible</a></li><li><a href="../è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/git" data-for="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/git">git</a></li><li><a href="../è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/github-actions" data-for="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/github-actions">github actions</a></li><li><a href="../è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/Jinja2" data-for="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/Jinja2">jinja2</a></li><li><a href="../è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹" data-for="è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹/è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹">è‡ªåŠ¨åŒ–å’Œç¼–ç¨‹</a></li></ul></div></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> â¯ </p></div><div class="breadcrumb-element"><a href="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/">äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–</a><p> â¯ </p></div><div class="breadcrumb-element"><a href>Openstack-Trainå®‰è£…</a></div></nav><h1 class="article-title">Openstack-Trainå®‰è£…</h1><p class="content-meta">2024å¹´5æœˆ27æ—¥, 55åˆ†é’Ÿé˜…è¯»</p><ul class="tags"><li><a href="../tags/äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–" class="internal tag-link">#äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–</a></li></ul></div></div><article class="popover-hint"><h2 id="åŸºç¡€ç¯å¢ƒå‡†å¤‡"><strong>åŸºç¡€ç¯å¢ƒå‡†å¤‡</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åŸºç¡€ç¯å¢ƒå‡†å¤‡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="èŠ‚ç‚¹è§„åˆ’"><strong>èŠ‚ç‚¹è§„åˆ’</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#èŠ‚ç‚¹è§„åˆ’" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>















































<div class="table-container"><table><thead><tr><th>åç§°</th><th>æè¿°</th><th>ç®¡ç†IP</th><th>ï¼ˆè™šæ‹Ÿæœºï¼‰å†…éƒ¨IP</th><th>é…ç½®</th></tr></thead><tbody><tr><td>ctl01</td><td>æ§åˆ¶èŠ‚ç‚¹</td><td>10.191.101.128/24</td><td>192.168.80.128/24</td><td>2C2G</td></tr><tr><td>compute01</td><td>è®¡ç®—èŠ‚ç‚¹</td><td>10.191.101.129/24</td><td>192.168.80.129/24</td><td>2C4G</td></tr><tr><td>neutron01</td><td>ç½‘ç»œèŠ‚ç‚¹</td><td>10.191.101.130/24</td><td>192.168.80.130/24</td><td>2C2G</td></tr><tr><td>cinder01</td><td>å­˜å‚¨èŠ‚ç‚¹</td><td>10.191.101.131/24</td><td>192.168.80.131/24</td><td>2C2G</td></tr><tr><td>(æ–°å¢)compute02</td><td>è®¡ç®—èŠ‚ç‚¹(win)</td><td>-</td><td>192.168.80.139/24</td><td>2C2G</td></tr></tbody></table></div>
<h3 id="ç³»ç»Ÿç‰ˆæœ¬"><strong>ç³»ç»Ÿç‰ˆæœ¬</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ç³»ç»Ÿç‰ˆæœ¬" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>CentOS Linux release 7.6.1810 (Core)</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/redhat-release</span></span></code></pre></figure>
<h3 id="è‡ªåŠ¨è¡¥å…¨"><strong>è‡ªåŠ¨è¡¥å…¨</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è‡ªåŠ¨è¡¥å…¨" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install bash-completion</span></span></code></pre></figure>
<h3 id="ä¸‹è½½åŒ…åˆ°æœ¬åœ°"><strong>ä¸‹è½½åŒ…åˆ°æœ¬åœ°</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ä¸‹è½½åŒ…åˆ°æœ¬åœ°" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -erobots=off</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -np</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reject=html,gif,A,D</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cut-dirs=4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/ http://mirrors.aliyun.com/centos/7/cloud/x86_64/openstack-train/</span></span></code></pre></figure>
<h3 id="é…ç½®æœ¬åœ°yum"><strong>é…ç½®æœ¬åœ°YUM</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é…ç½®æœ¬åœ°yum" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>/etc/yum.repos.d/Openstack-Train.repo</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Openstack-Train]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Openstack-Train</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseurl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">file:///opt/openstack-train/</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgcheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span></code></pre></figure>
<p>æŒ‚è½½å…‰ç›˜</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/cdrom</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iso9660 -o loop /dev/cdrom /mnt/cdrom</span></span></code></pre></figure>
<p>cat /etc/yum.repos.d/CentOS-iso.repo</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[CenOS-iso]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CenOS-iso</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseurl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">file:///mnt/cdrom/</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgcheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span></code></pre></figure>
<p>å†™å…¥é…ç½®æ–‡ä»¶ï¼Œ/etc/fstab</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/cdrom</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/cdrom iso9660 defaults,loop </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></figure>
<p>å¯ç”¨YUMç¼“å­˜</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@centos7 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# cat /etc/yum.conf</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[main]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cachedir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/var/cache/yum/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$basearch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$releasever</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">keepcache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></figure>
<h3 id="åŸºç¡€å·¥å…·å®‰è£…"><strong>åŸºç¡€å·¥å…·å®‰è£…</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åŸºç¡€å·¥å…·å®‰è£…" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install net-tools</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install wget</span></span></code></pre></figure>
<h3 id="æ›´æ”¹ä¸»æœºå"><strong>æ›´æ”¹ä¸»æœºå</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ›´æ”¹ä¸»æœºå" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>ä¸åŒè§’è‰²ä¸åŒåå­—åˆ†åˆ«è®¾ç½®</li>
</ul>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostnamectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-hostname ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostnamectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-hostname compute01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostnamectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-hostname neutron01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostnamectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-hostname cinder01</span></span></code></pre></figure>
<h3 id="é…ç½®ç½‘ç»œ"><strong>é…ç½®ç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é…ç½®ç½‘ç»œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>ç”±äºä½¿ç”¨VMware Workstationè¿›è¡Œéƒ¨ç½²ï¼Œéœ€è¦æ›´æ”¹åŸæœ‰çš„ç½‘ç»œé…ç½®</p>
<h4 id="ä¸»æœºç®¡ç†ç½‘ç»œ"><strong>ä¸»æœºç®¡ç†ç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ä¸»æœºç®¡ç†ç½‘ç»œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225433.png" width="auto" height="auto" alt/></p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225512.png" width="auto" height="auto" alt/></p>
<blockquote>
<p>æ³¨æ„NATè®¾ç½®ä¸­ï¼Œè®¾ç½®çš„ç½‘å…³IPä¸æœ¬æœºå¯¹åº”è™šæ‹Ÿç½‘å¡IPä¸å¯ä¸€è‡´ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸ä¸å¤–ç½‘é€šä¿¡ï¼Œè¯¥é—®é¢˜ç”±äºVMware Workstationè™šæ‹Ÿå®ç°çš„NATå’ŒDHCPé€ æˆï¼Œç½‘å…³æ˜¯è™šæ‹Ÿæœºçš„äº¤æ¢è®¾å¤‡ï¼Œæœ¬æœºvmnet8å’Œå¯¹åº”ipåˆ™ä½œä¸ºé€šä¿¡è½½ä½“ï¼Œä¸å¯ä½¿ç”¨åŒä¸€ä¸ªIP</p>
</blockquote>
<p>ç›¸å…³å‚è€ƒï¼š<a href="https://blog.51cto.com/u_13648313/2164309" class="external">https://blog.51cto.com/u_13648313/2164309<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>NATé…ç½®ç½‘å…³ä¸º10.191.101.2</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225532.png" width="auto" height="auto" alt/></p>
<blockquote>
<p>ä¸»æœºå¯¹åº”ç½‘å¡åœ°å€åˆ™é…ç½®ä¸º10.191.101.1ï¼Œæ­¤å¤–éœ€æŒ‡å®šé…ç½®DNS Serverï¼Œå¦åˆ™è™šæ‹Ÿä¸»æœºæ— æ³•è§£æåŸŸåï¼Œå¦‚æœéƒ¨åˆ†è™šæ‹Ÿæœºæ— æ³•æ­£å¸¸è·å–DNS Serveråœ°å€ï¼Œäº¦å¯åœ¨è™šæ‹Ÿæœºç½‘å¡é…ç½®ä¸­å†™å…¥DNS Server</p>
</blockquote>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225556.png" width="auto" height="auto" alt/></p>
<p>æ§åˆ¶èŠ‚ç‚¹</p>
<p>cat /etc/sysconfig/network-scripts/ifcfg-ens33</p>
<pre><code>TYPE=Ethernet
BOOTPROTO=static
DEFROUTE=yes
NAME=ens33
DEVICE=ens33
ONBOOT=yes
IPADDR=10.191.101.128
NETMASK=255.255.255.0
GATEWAY=10.191.101.2
</code></pre>
<p>è®¡ç®—èŠ‚ç‚¹</p>
<p>cat /etc/sysconfig/network-scripts/ifcfg-ens33</p>
<pre><code>TYPE=Ethernet
BOOTPROTO=static
DEFROUTE=yes
NAME=ens33
DEVICE=ens33
ONBOOT=yes
IPADDR=10.191.101.129
NETMASK=255.255.255.0
GATEWAY=10.191.101.2
</code></pre>
<h4 id="è™šæ‹Ÿæœºæµé‡ç½‘ç»œ"><strong>è™šæ‹Ÿæœºæµé‡ç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è™šæ‹Ÿæœºæµé‡ç½‘ç»œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225700.png" width="auto" height="auto" alt/></p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225717.png" width="auto" height="auto" alt/></p>
<p>æ§åˆ¶èŠ‚ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/sysconfig/network-scripts/ifcfg-ens33 /etc/sysconfig/network-scripts/ifcfg-ens34</span></span></code></pre></figure>
<p>cat /etc/sysconfig/network-scripts/ifcfg-ens34</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Ethernet</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BOOTPROTO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DEFROUTE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ens34</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DEVICE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ens34</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ONBOOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IPADDR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">192.168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.80.128</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NETMASK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255.255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.255.0</span></span></code></pre></figure>
<p>è®¡ç®—èŠ‚ç‚¹
cat /etc/sysconfig/network-scripts/ifcfg-ens34</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Ethernet</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BOOTPROTO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DEFROUTE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ens34</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DEVICE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ens34</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ONBOOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IPADDR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">192.168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.80.129</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NETMASK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255.255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.255.0</span></span></code></pre></figure>
<h4 id="æ–°å¢win-computeå¯¹ç½‘ç»œçš„è°ƒæ•´å¯é€‰">æ–°å¢win computeå¯¹ç½‘ç»œçš„è°ƒæ•´ï¼ˆå¯é€‰ï¼‰<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ–°å¢win-computeå¯¹ç½‘ç»œçš„è°ƒæ•´å¯é€‰" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åœ¨hyperväº¤æ¢æœºç®¡ç†æ–°å¢ä¸€ä¸ªå†…éƒ¨äº¤æ¢æœº</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240514174408.png" alt/></p>
<p>åœ¨å®¿ä¸»æœºï¼ˆæœ¬æœºï¼‰ç¡®è®¤åˆ›å»ºçš„äº¤æ¢æœºä¿¡æ¯</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240514174609.png" alt/></p>
<p>åœ¨workstationä¸­ä¿®æ”¹æˆ–åˆ›å»ºæ¡¥æ¥ç½‘ç»œåˆ°hypervè™šæ‹Ÿäº¤æ¢æœº</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240514175212.png" alt/></p>
<p>è°ƒæ•´å…¶ä»–openstackèŠ‚ç‚¹ï¼Œä¾‹å¦‚æ§åˆ¶èŠ‚ç‚¹ï¼Œè¿æ¥åˆ°æ¡¥æ¥hyperväº¤æ¢æœºçš„ç½‘å¡</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240514175335.png" alt/></p>
<p>åœ¨hypervè™šæ‹Ÿæœºï¼ˆè®¡ç®—èŠ‚ç‚¹ï¼‰ä¸­é…ç½®ä¸å…¶ä»–èŠ‚ç‚¹æŒ‡å®šç½‘å¡åŒç½‘æ®µåœ°å€æµ‹è¯•</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240514175527.png" alt/></p>
<p>æµ‹è¯•ç½‘ç»œè¿æ¥</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240514175637.png" alt/></p>
<h3 id="å…³é—­selinux"><strong>å…³é—­selinux</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å…³é—­selinux" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 's|SELINUX=enforcing|SELINUX=disabled|'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/selinux/config</span></span></code></pre></figure>
<h3 id="è¿æ¥æ•°é…ç½®"><strong>è¿æ¥æ•°é…ç½®</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è¿æ¥æ•°é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '* soft nofile 65530</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">* hard nofile 65530</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">* soft nproc 65530</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">* hard nproc 65530'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">>></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/security/limits.conf</span></span></code></pre></figure>
<h3 id="å…³é—­é˜²ç«å¢™"><strong>å…³é—­é˜²ç«å¢™</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å…³é—­é˜²ç«å¢™" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable firewalld</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop firewalld</span></span></code></pre></figure>
<h3 id="å…³é—­networkmanager"><strong>å…³é—­NetworkManager</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å…³é—­networkmanager" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable NetworkManager</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop NetworkManager</span></span></code></pre></figure>
<h3 id="hostsæ–‡ä»¶é…ç½®"><strong>HOSTSæ–‡ä»¶é…ç½®</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#hostsæ–‡ä»¶é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '10.191.101.128 ctl01</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10.191.101.129 compute01</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10.191.101.130 neutron01</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10.191.101.131 cinder01</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10.191.101.140 ceph01'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">>></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/hosts</span></span></code></pre></figure>
<h3 id="ntpæ—¶é’ŸåŒæ­¥"><strong>NTPæ—¶é’ŸåŒæ­¥</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ntpæ—¶é’ŸåŒæ­¥" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install -y chrony</span></span></code></pre></figure>
<p>è®¡ç®—èŠ‚ç‚¹å°†serverä¿®æ”¹ä¸ºæ§åˆ¶èŠ‚ç‚¹ip</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;server 10.191.101.128 iburst&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/chrony.conf</span></span></code></pre></figure>
<p>åŒæ­¥æ—¶é—´</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable chronyd.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart chronyd.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chronyc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sources</span></span></code></pre></figure>
<h2 id="æ•°æ®åº“"><strong>æ•°æ®åº“</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ•°æ®åº“" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<blockquote>
<p>Most OpenStack services use an SQL database to store information.</p>
</blockquote>
<p>å®‰è£…è½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install mariadb mariadb-server python2-PyMySQL</span></span></code></pre></figure>
<p>åˆ›å»ºå¹¶ç¼–è¾‘ /etc/my.cnf.d/openstack.cnf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[mysqld]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bind</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">191</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">default-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">storage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">engine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> innodb</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">innodb_file_per_table</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">max_connections </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4096</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">collation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8_general_ci</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">character-set-server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8</span></span></code></pre></figure>
<p>å¯åŠ¨æ•°æ®åº“ï¼Œé…ç½®å¼€æœºå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable mariadb.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart mariadb.service</span></span></code></pre></figure>
<p>åˆå§‹åŒ–æ•°æ®åº“,æœ¬æ¬¡æµ‹è¯•é…ç½®å¯†ç ä¸ºAbc-1234</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql_secure_installation</span></span></code></pre></figure>
<p>ï¼ˆå¯é€‰ï¼‰é…ç½®è¿œç¨‹rootç™»å½•</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Welcome </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> the MariaDB monitor.  Commands </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \g.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Your MariaDB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MariaDB MariaDB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Server</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Copyright (c) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2018</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Oracle, MariaDB Corporation Ab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> others.</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'help;'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '\h'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> help. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '\c'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> the current input </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">statement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MariaDB [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mysql;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reading </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> information </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> completion of </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> column names</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">You can turn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> this feature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a quicker startup </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> changed</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MariaDB [mysql]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> host,user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-----------+------+</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| host      | user |</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-----------+------+</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">127</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| ::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| ctl01     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| localhost | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-----------+------+</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sec)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MariaDB [mysql]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'root'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WITH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> GRANT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> OPTION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Query OK, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> affected (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sec)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MariaDB [mysql]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> host,user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-----------+------+</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| host      | user |</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-----------+------+</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| %         | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">127</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| ::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| ctl01     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> |</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-----------+------+</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sec)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MariaDB [mysql]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FLUSH PRIVILEGES;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Query OK, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> affected (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sec)</span></span>
<span data-line> </span></code></pre></figure>
<h2 id="æ¶ˆæ¯é˜Ÿåˆ—"><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ¶ˆæ¯é˜Ÿåˆ—" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<blockquote>
<p>OpenStack uses a message queue to coordinate operations and status information among services.</p>
</blockquote>
<p>å®‰è£…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install rabbitmq-server</span></span></code></pre></figure>
<p>å¼€æœºå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable rabbitmq-server.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart rabbitmq-server.service</span></span></code></pre></figure>
<p>æ–°å¢openstackç”¨æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rabbitmqctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add_user openstack Abc-1234</span></span></code></pre></figure>
<p>ä¸ºç”¨æˆ·é…ç½®æƒé™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rabbitmqctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set_permissions openstack &quot;.*&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;.*&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;.*&quot;</span></span></code></pre></figure>
<p>æ£€æŸ¥çŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status rabbitmq-server.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nltp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5672</span></span></code></pre></figure>
<h2 id="memcached"><strong>Memcached</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#memcached" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<blockquote>
<p>The Identity service authentication mechanism for services uses Memcached to cache tokens.</p>
</blockquote>
<p>å®‰è£…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install memcached python-memcached</span></span></code></pre></figure>
<p>é…ç½®/etc/sysconfig/memcachedï¼Œå…è®¸è®¿é—®çš„ip</p>
<blockquote>
<p>Configure the service to use the management IP address of the controller node. This is to enable access by other nodes via the management network</p>
</blockquote>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;11211&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;memcached&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MAXCONN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1024&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CACHESIZE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;64&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OPTIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-l 127.0.0.1,::1,ctl01&quot;</span></span></code></pre></figure>
<p>é…ç½®å¼€æœºå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable memcached.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart memcached.service</span></span></code></pre></figure>
<p>æ£€æŸ¥çŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status memcached.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nltup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11211</span></span></code></pre></figure>
<h2 id="etcd"><strong>Etcd</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#etcd" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<blockquote>
<p>OpenStack services may use Etcd, a distributed reliable key-value store for distributed key locking, storing configuration, keeping track of service live-ness and other scenarios.</p>
</blockquote>
<p>å®‰è£…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install etcd</span></span></code></pre></figure>
<p>å¤‡ä»½å’Œä¿®æ”¹é…ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/etcd/etcd.conf{,.bak}</span></span></code></pre></figure>
<blockquote>
<p>set the <code>ETCD_INITIAL_CLUSTER</code>, <code>ETCD_INITIAL_ADVERTISE_PEER_URLS</code>, <code>ETCD_ADVERTISE_CLIENT_URLS</code>, <code>ETCD_LISTEN_CLIENT_URLS</code> to the management IP address of the controller node to enable access by other nodes via the management network</p>
</blockquote>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#[Member]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_DATA_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/var/lib/etcd/default.etcd&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://10.191.101.128:2380&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://10.191.101.128:2379&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ctl01&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#[Clustering]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://10.191.101.128:2380&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://10.191.101.128:2379&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ctl01=http://10.191.101.128:2380&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;etcd-cluster-01&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;new&quot;</span></span></code></pre></figure>
<p>é…ç½®å¼€æœºå¯åŠ¨å’Œæ£€æŸ¥çŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable etcd</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart etcd</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status etcd</span></span></code></pre></figure>
<h2 id="å¯†ç è§„åˆ’"><strong>å¯†ç è§„åˆ’</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å¯†ç è§„åˆ’" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>































































































<div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><strong>Password name</strong></td><td><strong>Description</strong></td><td><strong>Key</strong></td></tr><tr><td>Database password (no variable used)</td><td>Root password for the database</td><td>Abc-1234</td></tr><tr><td><strong>ADMIN_PASS</strong></td><td>Password of user <strong>admin</strong></td><td>Abc-1234</td></tr><tr><td><strong>CINDER_DBPASS</strong></td><td>Database password for the Block Storage service</td><td>Abc-1234</td></tr><tr><td><strong>CINDER_PASS</strong></td><td>Password of Block Storage service user <strong>cinder</strong></td><td>Abc-1234</td></tr><tr><td><strong>DASH_DBPASS</strong></td><td>Database password for the Dashboard</td><td>Abc-1234</td></tr><tr><td><strong>DEMO_PASS</strong></td><td>Password of user <strong>demo</strong></td><td>Abc-1234</td></tr><tr><td><strong>GLANCE_DBPASS</strong></td><td>Database password for Image service</td><td>Abc-1234</td></tr><tr><td><strong>GLANCE_PASS</strong></td><td>Password of Image service user <strong>glance</strong></td><td>Abc-1234</td></tr><tr><td><strong>KEYSTONE_DBPASS</strong></td><td>Database password of Identity service</td><td>Abc-1234</td></tr><tr><td><strong>METADATA_SECRET</strong></td><td>Secret for the metadata proxy</td><td>Abc-1234</td></tr><tr><td><strong>NEUTRON_DBPASS</strong></td><td>Database password for the Networking service</td><td>Abc-1234</td></tr><tr><td><strong>NEUTRON_PASS</strong></td><td>Password of Networking service user <strong>neutron</strong></td><td>Abc-1234</td></tr><tr><td><strong>NOVA_DBPASS</strong></td><td>Database password for Compute service</td><td>Abc-1234</td></tr><tr><td><strong>NOVA_PASS</strong></td><td>Password of Compute service user <strong>nova</strong></td><td>Abc-1234</td></tr><tr><td><strong>PLACEMENT_PASS</strong></td><td>Password of the Placement service user <strong>placement</strong></td><td>Abc-1234</td></tr><tr><td><strong>RABBIT_PASS</strong></td><td>Password of RabbitMQ user <strong>openstack</strong></td><td>Abc-1234</td></tr></tbody></table></div>
<h2 id="minimal-deployment-for-train"><strong>Minimal deployment for Train</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#minimal-deployment-for-train" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<blockquote>
<p>æœ¬æ¬¡å®‰è£…trainç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬å¯å‚è€ƒå®˜ç½‘ç›¸å…³æ‰‹å†Œï¼Œæœ€å°åŒ–çš„trainç‰ˆæœ¬å®‰è£…å¿…é¡»åŒ…å«ä¸‹é¢çš„è¿™äº›æœåŠ¡ï¼Œé€æ­¥å¼€å§‹</p>
</blockquote>
<blockquote>
<p>At a minimum, you need to install the following services. Install the services in the order specified below</p>
</blockquote>
<ul>
<li>
<p>Identity service â€“ keystone installation for Train
<a href="https://docs.openstack.org/keystone/train/install/" class="external">https://docs.openstack.org/keystone/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
<li>
<p>Image service â€“ glance installation for Train
<a href="https://docs.openstack.org/glance/train/install/" class="external">https://docs.openstack.org/glance/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
<li>
<p>Placement service â€“ placement installation for Train
<a href="https://docs.openstack.org/placement/train/install/" class="external">https://docs.openstack.org/placement/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
<li>
<p>Compute service â€“ nova installation for Train
<a href="https://docs.openstack.org/nova/train/install/" class="external">https://docs.openstack.org/nova/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
<li>
<p>Networking service â€“ neutron installation for Train
<a href="https://docs.openstack.org/neutron/train/install/" class="external">https://docs.openstack.org/neutron/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
</ul>
<blockquote>
<p>We advise to also install the following components after you have installed the minimal deployment services</p>
</blockquote>
<ul>
<li>
<p>Dashboard â€“ horizon installation for Train
<a href="https://docs.openstack.org/horizon/train/install/" class="external">https://docs.openstack.org/horizon/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
<li>
<p>Block Storage service â€“ cinder installation for Train
<a href="https://docs.openstack.org/cinder/train/install/" class="external">https://docs.openstack.org/cinder/train/install/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
</ul>
<h3 id="keystone"><strong>Keystone</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#keystone" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<blockquote>
<p>The OpenStack Identity service provides a single point of integration for managing authentication, authorization, and a catalog of services.</p>
</blockquote>
<h4 id="å…ˆå†³æ¡ä»¶"><strong>å…ˆå†³æ¡ä»¶</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å…ˆå†³æ¡ä»¶" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åœ¨é…ç½® OpenStack èº«ä»½è®¤è¯æœåŠ¡å‰ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œç®¡ç†å‘˜ä»¤ç‰Œ</p>
<p>ç™»å½•æ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root -p</span></span></code></pre></figure>
<p>åˆ›å»ºå’Œé…ç½®æ•°æ®è¡¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> keystone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>å¯¹<code>keystone</code>æ•°æ®åº“æˆäºˆæ°å½“çš„æƒé™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> keystone.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'keystone'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> keystone.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'keystone'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<h4 id="é…ç½®ç»„ä»¶"><strong>é…ç½®ç»„ä»¶</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é…ç½®ç»„ä»¶" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>å®‰è£…ç»„ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-keystone httpd mod_wsgi</span></span></code></pre></figure>
<p>å¤‡ä»½å’Œé…ç½®/etc/keystone/keystone.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/keystone/keystone.conf{,.bak}</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/keystone/keystone.conf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">egrep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;#|^$&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[database]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = mysql+pymysql://keystone:Abc-1234@ctl01/keystone</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[token]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = fernet</span></span></code></pre></figure>
<p>å¡«å……æ•°æ®åº“å¹¶éªŒè¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;keystone-manage db_sync&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> keystone -e 'show tables'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ERROR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1045</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">28000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">: Access denied for user 'root'@'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (using </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">password: NO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>æŠ¥é”™å¤„ç†ï¼Œå¤‡ä»½å’Œä¿®æ”¹é…ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/my.cnf.d/mariadb-server.cnf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/my.cnf.d/mariadb-server.cnf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;^$\|#&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[mysqld]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">skip-grant-tables</span></span></code></pre></figure>
<p>é‡å¯æ•°æ®åº“æ£€æŸ¥</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart mariadb.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> keystone -e 'show tables'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+------------------------------------+</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Tables_in_keystone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                 |</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+------------------------------------+</span></span></code></pre></figure>
<p>åˆå§‹åŒ–Fernet keys</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keystone-manage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fernet_setup --keystone-user keystone --keystone-group keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keystone-manage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> credential_setup --keystone-user keystone --keystone-group keystone</span></span></code></pre></figure>
<p>å¼•å¯¼èº«ä»½æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keystone-manage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bootstrap --bootstrap-password Abc-1234 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--bootstrap-admin-url </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://ctl01:5000/v3/ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--bootstrap-internal-url </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://ctl01:5000/v3/ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--bootstrap-public-url </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://ctl01:5000/v3/ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--bootstrap-region-id </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RegionOne</span></span></code></pre></figure>
<h4 id="é…ç½®apache-httpæœåŠ¡å™¨"><strong>é…ç½®Apache HTTPæœåŠ¡å™¨</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é…ç½®apache-httpæœåŠ¡å™¨" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>é…ç½®servernameä¸ºæ§åˆ¶èŠ‚ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/httpd/conf/httpd.conf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ServerName&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ServerName gives the name and port that the server uses to identify itself.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ServerName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ctl01</span></span></code></pre></figure>
<p>åˆ›å»ºé…ç½®æ–‡ä»¶è½¯è¿æ¥</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/keystone/wsgi-keystone.conf /etc/httpd/conf.d/</span></span></code></pre></figure>
<p>é…ç½®å¼€æœºå¯åŠ¨å’Œæ£€æŸ¥çŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable httpd.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart httpd.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status httpd.service</span></span></code></pre></figure>
<p>ä¸ºadminç”¨æˆ·æ·»åŠ ç¯å¢ƒå˜é‡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/admin-openrc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EOF</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_USERNAME=admin</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_PASSWORD=Abc-1234</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_PROJECT_NAME=admin</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_USER_DOMAIN_NAME=Default</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_PROJECT_DOMAIN_NAME=Default</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_AUTH_URL=http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">export OS_IDENTITY_API_VERSION=3</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></figure>
<h4 id="åˆ›å»ºåŸŸé¡¹ç›®ç”¨æˆ·å’Œè§’è‰²"><strong>åˆ›å»ºåŸŸï¼Œé¡¹ç›®ï¼Œç”¨æˆ·å’Œè§’è‰²</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºåŸŸé¡¹ç›®ç”¨æˆ·å’Œè§’è‰²" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åˆ›å»ºåŸŸçš„æ–¹æ³•</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> domain create --description &quot;An Example Domain&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> example</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-bash:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openstack: command not found</span></span></code></pre></figure>
<p>æŠ¥é”™å¤„ç†ï¼Œå®‰è£…openstackå®¢æˆ·ç«¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install python-openstackclient</span></span></code></pre></figure>
<p>åˆ›å»ºserviceé¡¹ç›®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> project create --domain default --description &quot;Service Project&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span></span></code></pre></figure>
<p>åˆ›å»ºmyprojecté¡¹ç›®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> project create --domain default --description &quot;Demo Project&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myproject</span></span></code></pre></figure>
<p>åˆ›å»ºmyuserç”¨æˆ·ï¼Œæ­¤å¤„å¯†ç ä½¿ç”¨Abc-1234(â€”password-promptä¸ºäº¤äº’å¼,â€”password+å¯†ç ä¸ºéäº¤äº’å¼)</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user create --domain default --password-prompt myuser</span></span></code></pre></figure>
<p>åˆ›å»ºmyroleè§’è‰²</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role create myrole</span></span></code></pre></figure>
<p>æŸ¥çœ‹è§’è‰²</p>
<pre><code>[root@ctl01 ~]# openstack role list
+----------------------------------+--------+
| ID                               | Name   |
+----------------------------------+--------+
| 4bd9bb8d39564e99abefb2d576b72f7e | member |
| 5171abb30ef24b11b31f58f5cffe81a1 | myrole |
| 8e1a7c8613a045949fbc1ecdb14dcfe7 | reader |
| bfc42249d4504d908ea2c416ce655a4f | admin  |
+----------------------------------+--------+
</code></pre>
<p>å°†è§’è‰²æ·»åŠ åˆ°myprojecté¡¹ç›®å’Œmyuserç”¨æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role add --project myproject --user myuser myrole</span></span></code></pre></figure>
<h4 id="éªŒè¯"><strong>éªŒè¯</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#éªŒè¯" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>å–æ¶ˆç¯å¢ƒå˜é‡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">unset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OS_AUTH_URL OS_PASSWORD</span></span></code></pre></figure>
<p>adminç”¨æˆ·è¯·æ±‚ä»¤ç‰ŒéªŒè¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-auth-url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://ctl01:5000/v3 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-project-domain-name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Default </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-user-domain-name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Default </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-project-name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">admin </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-username </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">admin token issue</span></span></code></pre></figure>
<p>myuserç”¨æˆ·è¯·æ±‚ä»¤ç‰ŒéªŒè¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-auth-url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://ctl01:5000/v3 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-project-domain-name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Default </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-user-domain-name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Default </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-project-name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">myproject </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-username </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">myuser token issue</span></span></code></pre></figure>
<p>éªŒè¯ç¯å¢ƒå˜é‡é…ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> token issue</span></span></code></pre></figure>
<h3 id="glance"><strong>Glance</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#glance" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="åˆ›å»ºå’Œé…ç½®æ•°æ®åº“"><strong>åˆ›å»ºå’Œé…ç½®æ•°æ®åº“</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºå’Œé…ç½®æ•°æ®åº“" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> glance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> glance.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'glance'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> glance.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'glance'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flush privileges;</span></span></code></pre></figure>
<p>åˆ›å»ºglanceç”¨æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user create --domain default --password-prompt glance</span></span></code></pre></figure>
<p>å°†adminåŠ å…¥serviceé¡¹ç›®å’Œglanceç”¨æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role add --project service --user glance admin</span></span></code></pre></figure>
<p>åˆ›å»ºglanceæœåŠ¡å®ä½“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service create --name glance --description &quot;OpenStack Image&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span></span></code></pre></figure>
<p>åˆ›å»ºglanceæœåŠ¡APIç«¯ç‚¹,OpenStackä½¿ç”¨ä¸‰ç§APIç«¯ç‚¹å˜ç§ä»£è¡¨æ¯ç§æœåŠ¡ï¼šadminã€internalã€public</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne image public http://ctl01:9292</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne image internal http://ctl01:9292</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne image admin http://ctl01:9292</span></span></code></pre></figure>
<h4 id="å®‰è£…glanceè½¯ä»¶åŒ…"><strong>å®‰è£…glanceè½¯ä»¶åŒ…</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å®‰è£…glanceè½¯ä»¶åŒ…" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-glance</span></span></code></pre></figure>
<p>ç¼–è¾‘glanceé…ç½®æ–‡ä»¶ /etc/glance/glance-api.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf</span></span></code></pre></figure>
<p>openstack-utilsèƒ½å¤Ÿè®©openstackå®‰è£…æ›´åŠ ç®€å•ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-utils</span></span></code></pre></figure>
<h4 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><strong>ä¿®æ”¹é…ç½®æ–‡ä»¶</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>é…ç½®æ•°æ®åº“è®¿é—®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf database connection  mysql+pymysql://glance:Abc-1234@ctl01/glance</span></span></code></pre></figure>
<p>é…ç½®èº«ä»½æœåŠ¡è®¿é—®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken www_authenticate_uri   http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken auth_url  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken memcached_servers  ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken project_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken user_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken username  glance</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf keystone_authtoken password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf paste_deploy flavor  keystone</span></span></code></pre></figure>
<p>é…ç½®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå’Œé•œåƒæ–‡ä»¶ä½ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store stores  file,http</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store default_store  file</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store filesystem_store_datadir  /var/lib/glance/images/</span></span></code></pre></figure>
<p>å¡«å……æ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;glance-manage db_sync&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> glance</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¿½ç•¥æ­¤è¾“å‡ºä¸­çš„ä»»ä½•å¼ƒç”¨æ¶ˆæ¯</span></span></code></pre></figure>
<p>å¼€æœºå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable openstack-glance-api.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-glance-api.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status openstack-glance-api.service</span></span></code></pre></figure>
<p>glance å¯åŠ¨æŠ¥é”™å¤„ç†ï¼šæ³¨æ„é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦å«æœ‰ç‰¹æ®Šç¼–ç å­—ç¬¦ï¼Œåœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ£€æŸ¥</p>
<pre><code>Dec 18 10:09:28 ctl01 glance-api[7727]: ERROR: 'ascii' codec can't decode byte 0xc2 in position 11: ordinal not in range(128)
</code></pre>
<p>è§£å†³æ–¹å¼ï¼šæ›´æ¢ç¼–ç æ–¹å¼
é—®é¢˜åŸå› ï¼Œasciiç¼–ç æ–¹å¼ä¸èƒ½ç¼–ç å…¶ä»–çš„å†…å®¹
åœ¨ cd /usr/lib/python2.7/site-packages/ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶sitecustomize.py
å†…å®¹ä¸º</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sitecustomize.py</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># this file can be anywhere in your Python path,</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># but it usually goes in ${pythondir}/lib/site-packages/</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sys</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sys.setdefaultencoding(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'utf-8'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>å†å¡«å……æ•°æ®åº“å³å¯</p>
<h4 id="éªŒè¯-1"><strong>éªŒè¯</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#éªŒè¯-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>ä¸‹è½½cirrosé•œåƒ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://download.cirros-cloud.net/0.4.0/cirros-0.4.0-x86_64-disk.img</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯æµè§ˆå™¨è¿›è¡Œä¸‹è½½åä¸Šä¼ åˆ°æ§åˆ¶èŠ‚ç‚¹</span></span></code></pre></figure>
<p>ä¸Šä¼ é•œåƒ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸æ¨èä½¿ç”¨å®˜æ–¹æ–‡æ¡£glance image-createè¿™æ ·çš„å†™æ³•ï¼Œæ–°ç‰ˆæœ¬çš„OpenStackå·²ç»ä¸æ”¯æŒï¼Œç»Ÿä¸€ä½¿ç”¨ä»¥openstackå¼€å¤´çš„å‘½ä»¤å†™æ³•</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image create --file ~/cirros-0.4.0-x86_64-disk.img --disk-format qcow2 --container-format bare --public cirros</span></span></code></pre></figure>
<p>æŸ¥çœ‹é•œåƒ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image list</span></span></code></pre></figure>
<p>æŸ¥çœ‹é•œåƒæœ¬åœ°æ–‡ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/glance/images/</span></span></code></pre></figure>
<h3 id="placement"><strong>Placement</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#placement" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<blockquote>
<p>The placement service enables other projects to track their own resources. Those projects can register/delete their own resources to/from placement via the placementÂ <a href="https://docs.openstack.org/api-ref/placement/" class="external">HTTP API<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>.</p>
</blockquote>
<h4 id="åˆ›å»ºå’Œé…ç½®æ•°æ®åº“-1"><strong>åˆ›å»ºå’Œé…ç½®æ•°æ®åº“</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºå’Œé…ç½®æ•°æ®åº“-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> placement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>æˆäºˆæƒé™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> placement.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'placement'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> placement.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'placement'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>é…ç½®ç”Ÿæ•ˆ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flush privileges;</span></span></code></pre></figure>
<p>åˆ›å»ºç”¨æˆ·å’Œæ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œæ­¤å¤„é…ç½®å¯†ç Abc-1234</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user create --domain default --password-prompt placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role add --project service --user placement admin</span></span></code></pre></figure>
<p>åˆ›å»ºæœåŠ¡å®ä½“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service create --name placement --description &quot;Placement API&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> placement</span></span></code></pre></figure>
<p>åˆ›å»ºplacement APIæœåŠ¡è®¿é—®ç«¯ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne placement public http://ctl01:8778</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne placement internal http://ctl01:8778</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne placement admin http://ctl01:8778</span></span></code></pre></figure>
<h4 id="å®‰è£…placementè½¯ä»¶åŒ…"><strong>å®‰è£…placementè½¯ä»¶åŒ…</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å®‰è£…placementè½¯ä»¶åŒ…" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-placement-api</span></span></code></pre></figure>
<h4 id="å¤‡ä»½å’Œä¿®æ”¹é…ç½®"><strong>å¤‡ä»½å’Œä¿®æ”¹é…ç½®</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å¤‡ä»½å’Œä¿®æ”¹é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf /etc/placement/placement.conf.bak</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf placement_database connection mysql+pymysql://placement:Abc-1234@ctl01/placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf api auth_strategy keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken auth_url  http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken memcached_servers ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken project_domain_name Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken user_domain_name Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken username placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/placement/placement.conf keystone_authtoken password Abc-1234</span></span></code></pre></figure>
<p>å¡«å……placementæ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ctl01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# su -s /bin/sh -c </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;placement-manage db sync&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/lib/python2.7/site-packages/pymysql/cursors.py:170:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Warning: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1280,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> u&quot;Name 'alembic_version_pkc' ignored for PRIMARY key.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  result</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = self._query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>æŠ¥é”™å¤„ç†ï¼Œå†æ‰§è¡Œä¸€æ¬¡</p>
<pre><code>[root@ctl01 ~]# su -s /bin/sh -c &quot;placement-manage db sync&quot; placement
</code></pre>
<p>ä¿®æ”¹placementçš„apacheé…ç½®æ–‡ä»¶ï¼Œå®˜æ–¹æ–‡æ¡£æ²¡æœ‰æåˆ°ï¼Œå¦‚æœä¸ä¿®æ”¹ï¼Œè®¡ç®—æœåŠ¡æ£€æŸ¥æ—¶å°†ä¼šæŠ¥é”™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#å¯ç”¨placement APIè®¿é—®ï¼Œåœ¨16è¡Œä¸‹å¢åŠ ä¸‹åˆ—é…ç½®æ®µ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/httpd/conf.d/00-placement-api.conf</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#SSLCertificateKeyFile</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#SSLCertificateKeyFile ...</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Directory /usr/bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IfVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">= 2.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">4></span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Require</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all granted</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/IfVersion</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IfVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 2.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">4></span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Order</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> allow,deny</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Allow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from all</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/IfVersion</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/Directory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></figure>
<h4 id="é‡å¯apacheæœåŠ¡éªŒè¯">é‡å¯apacheæœåŠ¡éªŒè¯<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é‡å¯apacheæœåŠ¡éªŒè¯" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart httpd.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status httpd.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lntup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8778</span></span></code></pre></figure>
<p>curlæµ‹è¯•è¿”å›json</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ctl01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# curl http://ctl01:8778</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;versions&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;status&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CURRENT&quot;, &quot;min_version&quot;: &quot;1.0&quot;, &quot;max_version&quot;: &quot;1.36&quot;, &quot;id&quot;: &quot;v1.0&quot;, &quot;links&quot;: [{&quot;href&quot;: &quot;&quot;, &quot;rel&quot;: &quot;self&quot;}]}]}</span></span></code></pre></figure>
<p>éªŒè¯æ£€æŸ¥å¥åº·çŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">placement-status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade check</span></span></code></pre></figure>
<h3 id="nova"><strong>Nova</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#nova" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="æ§åˆ¶èŠ‚ç‚¹"><strong>æ§åˆ¶èŠ‚ç‚¹</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ§åˆ¶èŠ‚ç‚¹" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åˆ›å»ºnova_apiï¼Œnovaå’Œnova_cell0æ•°æ®åº“å¹¶æˆæƒ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nova_api</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nova</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nova_cell0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nova_api.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'nova'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nova_api.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'nova'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nova.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'nova'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nova.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'nova'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nova_cell0.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'nova'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nova_cell0.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'nova'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flush privileges;</span></span></code></pre></figure>
<p>åˆ›å»ºå’Œé…ç½®novaè´¦æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user create --domain default --password Abc-1234 nova</span></span></code></pre></figure>
<p>å‘novaç”¨æˆ·æ·»åŠ adminè§’è‰²</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role add --project service --user nova admin</span></span></code></pre></figure>
<p>åˆ›å»ºnovaæœåŠ¡å®ä½“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service create --name nova --description &quot;OpenStack Compute&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute</span></span></code></pre></figure>
<p>åˆ›å»ºCompute APIæœåŠ¡ç«¯ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne compute public http://ctl01:8774/v2.1</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne compute internal http://ctl01:8774/v2.1</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne compute admin http://ctl01:8774/v2.1</span></span></code></pre></figure>
<p>å®‰è£…Novaç›¸å…³è½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-nova-api openstack-nova-conductor openstack-nova-novncproxy openstack-nova-scheduler</span></span></code></pre></figure>
<p>å¤‡ä»½å’Œç¼–è¾‘novaé…ç½®æ–‡ä»¶/etc/nova/nova.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In theÂ `[vnc]`Â section, configure the VNC proxy to use the management interface IP address of the controller node</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">my_ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.128</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf DEFAULT enabled_apis  osapi_compute,metadata</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf DEFAULT my_ip &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$my_ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf DEFAULT use_neutron  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf DEFAULT firewall_driver  nova.virt.firewall.NoopFirewallDriver</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf DEFAULT transport_url  rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf api_database connection  mysql+pymysql://nova:Abc-1234@ctl01/nova_api</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf database connection  mysql+pymysql://nova:Abc-1234@ctl01/nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement_database connection  mysql+pymysql://placement:Abc-1234@ctl01/placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf api auth_strategy  keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken auth_url  http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken memcached_servers  ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken project_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken user_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken username  nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf keystone_authtoken password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf vnc enabled  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf vnc server_listen  '$my_ip'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf vnc server_proxyclient_address  '$my_ip'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf glance api_servers  http://ctl01:9292</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf oslo_concurrency lock_path  /var/lib/nova/tmp</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement region_name  RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement project_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement user_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement auth_url  http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement username  placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf placement password  Abc-1234</span></span></code></pre></figure>
<p>å¡«å……nova-apiæ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage api_db sync&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage cell_v2 map_cell0&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage cell_v2 create_cell --name=cell1 --verbose&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage db sync&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/lib/python2.7/site-packages/pymysql/cursors.py:170:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Warning: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1831,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> u'Duplicate index `block_device_mapping_instance_uuid_virtual_name_device_name_idx`. This is deprecated and will be disallowed in a future release'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  result</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = self._query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/lib/python2.7/site-packages/pymysql/cursors.py:170:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Warning: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1831,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> u'Duplicate index `uniq_instances0uuid`. This is deprecated and will be disallowed in a future release'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  result</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = self._query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>æŠ¥é”™å¤„ç†ï¼Œå†æ‰§è¡Œä¸€æ¬¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage db sync&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span></code></pre></figure>
<p>éªŒè¯nova cell0å’Œcell1æ˜¯å¦æ­£ç¡®æ³¨å†Œ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage cell_v2 list_cells&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span></code></pre></figure>
<p>é…ç½®å¼€æœºå¯åŠ¨å’Œå¯åŠ¨æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-api.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-scheduler.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-conductor.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-novncproxy.service</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-api.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-scheduler.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-conductor.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-novncproxy.service</span></span></code></pre></figure>
<p>æ£€æŸ¥è¿è¡ŒçŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-api.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-scheduler.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-conductor.service </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack-nova-novncproxy.service</span></span></code></pre></figure>
<p>æ£€æŸ¥novaæœåŠ¡çŠ¶æ€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tnlup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">egrep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '8774|8775'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://ctl01:8774</span></span></code></pre></figure>
<h4 id="è®¡ç®—èŠ‚ç‚¹"><strong>è®¡ç®—èŠ‚ç‚¹</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è®¡ç®—èŠ‚ç‚¹" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>å®‰è£…è½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-nova-compute</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-utils</span></span></code></pre></figure>
<p>å¤‡ä»½å’Œç¼–è¾‘novaé…ç½®æ–‡ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">my_ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.129</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf DEFAULT enabled_apis  osapi_compute,metadata</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf DEFAULT transport_url  rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf DEFAULT my_ip &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$my_ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf DEFAULT use_neutron  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf DEFAULT firewall_driver  nova.virt.firewall.NoopFirewallDriver</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf api auth_strategy  keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken auth_url  http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken memcached_servers  ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken project_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken user_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken username  nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf keystone_authtoken password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf vnc enabled  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf vnc server_listen  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.0.0</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf vnc server_proxyclient_address '$my_ip'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf vnc novncproxy_base_url http://ctl01:6080/vnc_auto.html</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf glance api_servers  http://ctl01:9292</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf oslo_concurrency lock_path  /var/lib/nova/tmp</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement region_name  RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement project_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement user_domain_name  Default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement auth_url  http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement username  placement</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf placement password  Abc-1234</span></span></code></pre></figure>
<p>ç¡®å®šè®¡ç®—èŠ‚ç‚¹æ˜¯å¦æ”¯æŒè™šæ‹Ÿæœºç¡¬ä»¶åŠ é€Ÿ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">egrep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '(vmx|svm)'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /proc/cpuinfo</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¦‚æœæ­¤å‘½ä»¤è¿”å›å€¼ä¸æ˜¯0ï¼Œåˆ™è®¡ç®—èŠ‚ç‚¹æ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼Œä¸éœ€è¦åŠ å…¥ä¸‹é¢çš„é…ç½®ã€‚</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¦‚æœæ­¤å‘½ä»¤è¿”å›å€¼æ˜¯0ï¼Œåˆ™è®¡ç®—èŠ‚ç‚¹ä¸æ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼Œå¹¶ä¸”å¿…é¡»é…ç½®libvirtä¸ºä½¿ç”¨QEMUè€Œä¸æ˜¯KVMï¼Œéœ€è¦ç¼–è¾‘/etc/nova/nova.conf é…ç½®æ–‡ä»¶ä¸­çš„[libvirt]éƒ¨åˆ†ï¼š</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf libvirt virt_type  qemu</span></span></code></pre></figure>
<p>å¯åŠ¨è®¡ç®—èŠ‚ç‚¹çš„novaæœåŠ¡åŠå…¶ç›¸å…³æœåŠ¡ï¼Œå¹¶è®¾ç½®å¼€æœºè‡ªå¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¦‚æœnova-computeæœåŠ¡æ— æ³•å¯åŠ¨ï¼Œè¯·æ£€æŸ¥ /var/log/nova/nova-compute.logï¼Œè¯¥é”™è¯¯æ¶ˆæ¯å¯èƒ½è¡¨æ˜æ§åˆ¶å™¨èŠ‚ç‚¹ä¸Šçš„é˜²ç«å¢™é˜»æ­¢è®¿é—®ç«¯å£5672ï¼Œå°†é˜²ç«å¢™é…ç½®ä¸ºæ‰“å¼€æ§åˆ¶å™¨èŠ‚ç‚¹ä¸Šçš„ç«¯å£5672å¹¶é‡æ–°å¯åŠ¨è®¡ç®—èŠ‚ç‚¹ä¸Šçš„æœåŠ¡</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart libvirtd.service openstack-nova-compute.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable libvirtd.service openstack-nova-compute.service</span></span></code></pre></figure>
<p>åœ¨æ§åˆ¶èŠ‚ç‚¹ï¼ˆctl01ï¼‰ä¸ŠéªŒè¯è®¡ç®—èŠ‚ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute service list --service nova-compute</span></span></code></pre></figure>
<p>æ§åˆ¶èŠ‚ç‚¹ä¸Šå‘ç°è®¡ç®—ä¸»æœº</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ æ¯å°æ–°çš„è®¡ç®—èŠ‚ç‚¹æ—¶ï¼Œå¿…é¡»åœ¨æ§åˆ¶å™¨èŠ‚ç‚¹ä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æ³¨å†Œè¿™äº›æ–°çš„è®¡ç®—èŠ‚ç‚¹</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;nova-manage cell_v2 discover_hosts --verbose&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nova</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¹Ÿå¯ä»¥è®¾ç½®é€‚å½“çš„å‘ç°æ—¶é—´é—´éš”æ¥æ·»åŠ æ–°çš„è®¡ç®—èŠ‚ç‚¹</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf scheduler discover_hosts_in_cells_interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-nova-api.service</span></span></code></pre></figure>
<h4 id="åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸ŠéªŒè¯novaæœåŠ¡"><strong>åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸ŠéªŒè¯novaæœåŠ¡</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸ŠéªŒè¯novaæœåŠ¡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åˆ—å‡ºæœåŠ¡ç»„ä»¶ä»¥éªŒè¯æ¯ä¸ªè¿›ç¨‹çš„æˆåŠŸå¯åŠ¨å’Œæ³¨å†Œæƒ…å†µ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute service list</span></span></code></pre></figure>
<p>åˆ—å‡ºèº«ä»½æœåŠ¡ä¸­çš„APIç«¯ç‚¹ä»¥éªŒè¯ä¸èº«ä»½æœåŠ¡çš„è¿æ¥</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> catalog list</span></span></code></pre></figure>
<p>åˆ—å‡ºé•œåƒæœåŠ¡ä¸­çš„é•œåƒä»¥éªŒè¯ä¸é•œåƒæœåŠ¡çš„è¿æ¥æ€§</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image list</span></span></code></pre></figure>
<p>æ£€æŸ¥Cellså’Œplacement APIæ˜¯å¦æ­£å¸¸è¿è¡Œ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nova-status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade check</span></span></code></pre></figure>
<h4 id="windowsè®¡ç®—èŠ‚ç‚¹">Windowsè®¡ç®—èŠ‚ç‚¹<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#windowsè®¡ç®—èŠ‚ç‚¹" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<h3 id="neutron"><strong>Neutron</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#neutron" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="æ§åˆ¶èŠ‚ç‚¹-1"><strong>æ§åˆ¶èŠ‚ç‚¹</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ§åˆ¶èŠ‚ç‚¹-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åˆ›å»ºneutronæ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">uroot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pAbc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1234</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> neutron</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> neutron.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'neutron'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> neutron.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'neutron'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flush privileges;</span></span></code></pre></figure>
<p>åˆ›å»ºneutronç”¨æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user create --domain default --password Abc-1234 neutron</span></span></code></pre></figure>
<p>å‘neutronç”¨æˆ·æ·»åŠ adminè§’è‰²</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role add --project service --user neutron admin</span></span></code></pre></figure>
<p>åˆ›å»ºneutronæœåŠ¡å®ä½“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service create --name neutron --description &quot;OpenStack Networking&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network</span></span></code></pre></figure>
<p>åˆ›å»ºneutronæœåŠ¡ç«¯ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne network public http://ctl01:9696</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne network internal http://ctl01:9696</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne network admin http://ctl01:9696</span></span></code></pre></figure>
<h5 id="provider-networks"><strong>Provider Networks</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#provider-networks" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>å®‰è£…neutronè½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-neutron openstack-neutron-ml2 openstack-neutron-linuxbridge ebtables</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># openstack-neutronï¼šneutron-serverçš„åŒ…</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># openstack-neutron-ml2ï¼šML2 pluginçš„åŒ…</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># openstack-neutron-linuxbridgeï¼šlinux bridge network providerç›¸å…³çš„åŒ…</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ebtablesï¼šé˜²ç«å¢™ç›¸å…³çš„åŒ…</span></span></code></pre></figure>
<p>ç¼–è¾‘neutronæœåŠ¡é…ç½®æ–‡ä»¶/etc/neutron/neutron.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®äºŒå±‚ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf database connection  mysql+pymysql://neutron:Abc-1234@ctl01/neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT core_plugin ml2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT service_plugins router</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT allow_overlapping_ips </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT transport_url  rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT auth_strategy  keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_status_changes  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_data_changes  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken auth_url  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken memcached_servers  ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken project_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken user_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken username  neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf oslo_concurrency lock_path  /var/lib/neutron/tmp</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  auth_url http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  project_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  user_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  region_name RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  username nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  password Abc-1234</span></span></code></pre></figure>
<h5 id="ml2-pluginçš„é…ç½®æ–‡ä»¶ml2_confini"><strong>ML2 pluginçš„é…ç½®æ–‡ä»¶ml2_conf.ini</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ml2-pluginçš„é…ç½®æ–‡ä»¶ml2_confini" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 type_drivers  flat,vlan,vxlan</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 tenant_network_types vxlan</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 mechanism_drivers  linuxbridge,l2population</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 extension_drivers  port_security</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_flat flat_networks  provider</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini linux_bridge physical_interface_mappings provider:ens33</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_vxlan vni_ranges </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:1000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup enable_ipset  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></figure>
<h5 id="é…ç½®linuxç½‘æ¡¥ä»£ç†"><strong>é…ç½®linuxç½‘æ¡¥ä»£ç†</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#é…ç½®linuxç½‘æ¡¥ä»£ç†" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>Linuxç½‘æ¡¥ä»£ç†ä¸ºå®ä¾‹æ„å»ºç¬¬2å±‚ï¼ˆæ¡¥æ¥å’Œäº¤æ¢ï¼‰è™šæ‹Ÿç½‘ç»œåŸºç¡€ç»“æ„å¹¶å¤„ç†å®‰å…¨ç»„</p>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/neutron/plugins/ml2/linuxbridge_agent.ini</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®˜æ–¹é…ç½®æ–‡æ¡£ä¸­ï¼Œ</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PROVIDER_INTERFACE_NAMEæŒ‡çš„æ˜¯eth0ç½‘å¡ï¼Œå°±æ˜¯è¿æ¥å¤–éƒ¨ç½‘ç»œçš„é‚£å—ç½‘å¡</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OVERLAY_INTERFACE_IP_ADDRESSæŒ‡çš„æ˜¯æ§åˆ¶èŠ‚ç‚¹è®¿é—®å¤–ç½‘çš„IPåœ°å€</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings  provider:ens33</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan local_ip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.128</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan l2_population </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver  neutron.agent.linux.iptables_firewall.IptablesFirewallDriver</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹linuxå†…æ ¸å‚æ•°è®¾ç½®ä¸º1</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.bridge.bridge-nf-call-iptables=1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.bridge.bridge-nf-call-ip6tables=1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯ç”¨ç½‘ç»œæ¡¥æ¥å™¨æ”¯æŒï¼ŒåŠ è½½ br_netfilter å†…æ ¸æ¨¡å—</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modprobe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> br_netfilter</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span>
<span data-line> </span></code></pre></figure>
<p>é…ç½®ç¬¬3å±‚ l3ä»£ç†ä¸ºè‡ªåŠ©å¼è™šæ‹Ÿç½‘ç»œæä¾›è·¯ç”±å’ŒNATæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®ä¸‰å±‚ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini DEFAULT interface_driver linuxbridge</span></span></code></pre></figure>
<p>é…ç½®DHCPä»£ç†ï¼ŒDHCPä»£ç†ä¸ºè™šæ‹Ÿç½‘ç»œæä¾›DHCPæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/neutron/dhcp_agent.ini</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/dhcp_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/dhcp_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/dhcp_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/dhcp_agent.ini DEFAULT interface_driver linuxbridge</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/dhcp_agent.ini DEFAULT dhcp_driver neutron.agent.linux.dhcp.Dnsmasq</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/dhcp_agent.ini DEFAULT enable_isolated_metadata </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></figure>
<p>é…ç½®å…ƒæ•°æ®ä»£ç†</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…ƒæ•°æ®ä»£ç†æä¾›é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚å®ä¾‹çš„å‡­æ®</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/neutron/metadata_agent.ini ï¼Œå¹¶ä¸ºå…ƒæ•°æ®è®¾ç½®å¯†ç METADATA_SECRET</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/metadata_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/metadata_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/metadata_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/metadata_agent.ini DEFAULT nova_metadata_host  controller</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/metadata_agent.ini DEFAULT metadata_proxy_shared_secret  Abc-1234</span></span>
<span data-line> </span></code></pre></figure>
<p>åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šé…ç½®NovaæœåŠ¡ä¸ç½‘ç»œæœåŠ¡è¿›è¡Œäº¤äº’</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/nova/nova.conf</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron url  http://ctl01:9696</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron auth_url  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron project_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron user_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron region_name  RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron username  neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron service_metadata_proxy  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron metadata_proxy_shared_secret  Abc-1234</span></span></code></pre></figure>
<p>åˆ›å»ºml2çš„è½¯è¿æ¥ æ–‡ä»¶æŒ‡å‘ML2æ’ä»¶é…ç½®çš„è½¯é“¾æ¥</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini /etc/neutron/plugin.ini</span></span></code></pre></figure>
<p>å¡«å……æ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;neutron-db-manage --config-file /etc/neutron/neutron.conf </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">--config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> neutron</span></span></code></pre></figure>
<p>é‡æ–°å¯åŠ¨nova APIè®¡ç®—æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-nova-api.service</span></span></code></pre></figure>
<p>å¯åŠ¨neutronæœåŠ¡å’Œé…ç½®å¼€æœºå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable neutron-server.service neutron-linuxbridge-agent.service neutron-dhcp-agent.service neutron-metadata-agent.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart neutron-server.service neutron-linuxbridge-agent.service neutron-dhcp-agent.service neutron-metadata-agent.service</span></span></code></pre></figure>
<p>å› é…ç½®äº†ç¬¬3å±‚l3ç½‘ç»œæœåŠ¡ éœ€è¦å¯åŠ¨ç¬¬ä¸‰å±‚æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable neutron-l3-agent.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart neutron-l3-agent.service</span></span></code></pre></figure>
<h4 id="è®¡ç®—èŠ‚ç‚¹å®‰è£…neutronæœåŠ¡"><strong>è®¡ç®—èŠ‚ç‚¹å®‰è£…neutronæœåŠ¡</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#è®¡ç®—èŠ‚ç‚¹å®‰è£…neutronæœåŠ¡" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>å®‰è£…ç»„ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-neutron-linuxbridge ebtables ipset</span></span></code></pre></figure>
<p>ä¿®æ”¹neutronä¸»é…ç½®æ–‡ä»¶/etc/neutron/neutron.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT transport_url rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT auth_strategy keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken auth_url http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken memcached_servers ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken project_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken user_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken username neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken password Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf oslo_concurrency lock_path /var/lib/neutron/tmp</span></span></code></pre></figure>
<p>é…ç½®Linuxç½‘æ¡¥ä»£ç†</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings  provider:ens33</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan local_ip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.129</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan l2_population </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver  neutron.agent.linux.iptables_firewall.IptablesFirewallDriver</span></span></code></pre></figure>
<p>ä¿®æ”¹linuxç³»ç»Ÿå†…æ ¸ç½‘æ¡¥å‚æ•°ä¸º1</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.bridge.bridge-nf-call-iptables=1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.bridge.bridge-nf-call-ip6tables=1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modprobe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> br_netfilter</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></figure>
<p>é…ç½®è®¡ç®—èŠ‚ç‚¹ä¸ŠNovaæœåŠ¡ä½¿ç”¨ç½‘ç»œæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹novaé…ç½®æ–‡ä»¶/etc/nova/nova.confï¼Œæ·»åŠ neutronæ¨¡å—é…ç½®</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron auth_url http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron project_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron user_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron region_name RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron username neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron password Abc-1234</span></span></code></pre></figure>
<p>é‡æ–°å¯åŠ¨è®¡ç®—èŠ‚ç‚¹ä¸Šçš„NovaæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-nova-compute.service</span></span></code></pre></figure>
<p>å¯åŠ¨neutronç½‘æ¡¥ä»£ç†æœåŠ¡ è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable neutron-linuxbridge-agent.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart neutron-linuxbridge-agent.service</span></span></code></pre></figure>
<p>å›åˆ°æ§åˆ¶èŠ‚ç‚¹éªŒè¯Neutronç½‘ç»œæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ—å‡ºå·²åŠ è½½çš„æ‰©å±•ï¼Œä»¥éªŒè¯è¯¥neutron-serverè¿‡ç¨‹æ˜¯å¦æˆåŠŸå¯åŠ¨</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> extension list --network</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ—å‡ºä»£ç†å•†ä»¥éªŒè¯æˆåŠŸ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network agent list</span></span></code></pre></figure>
<h4 id="å®‰è£…neutronç½‘ç»œæœåŠ¡èŠ‚ç‚¹"><strong>å®‰è£…neutronç½‘ç»œæœåŠ¡èŠ‚ç‚¹</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å®‰è£…neutronç½‘ç»œæœåŠ¡èŠ‚ç‚¹" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>ç½‘ç»œé…ç½®æŒ‰ç…§å®˜ç½‘æ–‡æ¡£çš„ç§Ÿæˆ·è‡ªåŠ©ç½‘ç»œ</p>
<p>é…ç½®ç³»ç»Ÿå‚æ•°</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.ipv4.ip_forward = 1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></figure>
<p>å®‰è£…å®¢æˆ·ç«¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install python-openstackclient</span></span></code></pre></figure>
<p>å®‰è£…ç»„ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-neutron openstack-neutron-ml2 openstack-neutron-linuxbridge ebtables openstack-utils</span></span></code></pre></figure>
<p>ç¼–è¾‘neutronæœåŠ¡é…ç½®æ–‡ä»¶/etc/neutron/neutron.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®äºŒå±‚ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/neutron.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf database connection  mysql+pymysql://neutron:Abc-1234@ctl01/neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT core_plugin ml2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT service_plugins router</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT allow_overlapping_ips </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT transport_url  rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT auth_strategy  keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_status_changes  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_data_changes  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken www_authenticate_uri  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken auth_url  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken memcached_servers  ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken project_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken user_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken username  neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf keystone_authtoken password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf oslo_concurrency lock_path  /var/lib/neutron/tmp</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  auth_url http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  project_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  user_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  region_name RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  username nova</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/neutron.conf nova  password Abc-1234</span></span></code></pre></figure>
<p>ML2 pluginçš„é…ç½®æ–‡ä»¶ml2_conf.ini</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 type_drivers  flat,vlan,vxlan</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 tenant_network_types vxlan</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 mechanism_drivers  linuxbridge,l2population</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2 extension_drivers  port_security</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_flat flat_networks  provider</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_vxlan vni_ranges </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:1000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup enable_ipset  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></figure>
<p>é…ç½®Linuxç½‘æ¡¥ä»£ç†</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linuxç½‘æ¡¥ä»£ç†ä¸ºå®ä¾‹æ„å»ºç¬¬2å±‚ï¼ˆæ¡¥æ¥å’Œäº¤æ¢ï¼‰è™šæ‹Ÿç½‘ç»œåŸºç¡€ç»“æ„å¹¶å¤„ç†å®‰å…¨ç»„</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/neutron/plugins/ml2/linuxbridge_agent.ini</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®˜ç½‘é…ç½®æ–‡æ¡£ä¸­ï¼š</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PROVIDER_INTERFACE_NAMEæŒ‡çš„æ˜¯eth0ç½‘å¡ï¼Œå°±æ˜¯è¿æ¥å¤–éƒ¨ç½‘ç»œçš„é‚£å—ç½‘å¡</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OVERLAY_INTERFACE_IP_ADDRESSæŒ‡çš„æ˜¯æ§åˆ¶èŠ‚ç‚¹è®¿é—®å¤–ç½‘çš„IPåœ°å€</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini linux_bridge physical_interface_mappings  provider:ens33</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan enable_vxlan  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan local_ip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.130</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini vxlan l2_population </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup enable_security_group  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/linuxbridge_agent.ini securitygroup firewall_driver  neutron.agent.linux.iptables_firewall.IptablesFirewallDriver</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹linuxå†…æ ¸å‚æ•°è®¾ç½®ä¸º1</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.bridge.bridge-nf-call-iptables=1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'net.bridge.bridge-nf-call-ip6tables=1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/sysctl.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯ç”¨ç½‘ç»œæ¡¥æ¥å™¨æ”¯æŒï¼ŒåŠ è½½ br_netfilter å†…æ ¸æ¨¡å—</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modprobe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> br_netfilter</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></figure>
<p>é…ç½®ç¬¬3å±‚ l3ä»£ç†ä¸ºè‡ªåŠ©å¼è™šæ‹Ÿç½‘ç»œæä¾›è·¯ç”±å’ŒNATæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®ä¸‰å±‚ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/l3_agent.ini DEFAULT interface_driver linuxbridge</span></span></code></pre></figure>
<p>é…ç½®DHCPä»£ç†ï¼ŒDHCPä»£ç†ä¸ºè™šæ‹Ÿç½‘ç»œæä¾›DHCPæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/neutron/dhcp_agent.ini</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/dhcp_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/dhcp_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/dhcp_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/dhcp_agent.ini DEFAULT interface_driver linuxbridge</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/dhcp_agent.ini DEFAULT dhcp_driver neutron.agent.linux.dhcp.Dnsmasq</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/dhcp_agent.ini DEFAULT enable_isolated_metadata </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></figure>
<p>é…ç½®å…ƒæ•°æ®ä»£ç†</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…ƒæ•°æ®ä»£ç†æä¾›é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚å®ä¾‹çš„å‡­æ®</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/neutron/metadata_agent.ini ï¼Œå¹¶ä¸ºå…ƒæ•°æ®è®¾ç½®å¯†ç METADATA_SECRET</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/metadata_agent.ini{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/metadata_agent.ini.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/metadata_agent.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/metadata_agent.ini DEFAULT nova_metadata_host  controller</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/neutron/metadata_agent.ini DEFAULT metadata_proxy_shared_secret  Abc-1234</span></span></code></pre></figure>
<p>åˆ›å»ºml2çš„è½¯è¿æ¥ æ–‡ä»¶æŒ‡å‘ML2æ’ä»¶é…ç½®çš„è½¯é“¾æ¥</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini /etc/neutron/plugin.ini</span></span></code></pre></figure>
<p>å¡«å……æ•°æ®åº“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;neutron-db-manage --config-file /etc/neutron/neutron.conf --config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> neutron</span></span></code></pre></figure>
<p>åœ¨ctl01æ§åˆ¶èŠ‚ç‚¹ä¸Šé…ç½®novaæœåŠ¡ä¸ç½‘ç»œèŠ‚ç‚¹æœåŠ¡è¿›è¡Œäº¤äº’
å¦‚æœæ˜¯å•ç‹¬å®‰è£…ç½‘ç»œèŠ‚ç‚¹åˆ™æ·»åŠ ä»¥ä¸‹æ“ä½œï¼Œå¦‚æœå·²ç»åœ¨é…ç½®è®¡ç®—èŠ‚ç‚¹çš„ç½‘ç»œæœåŠ¡æ—¶ï¼Œåœ¨æ§åˆ¶èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶/etc/nova/nova.confæ·»åŠ äº†neutronæ¨¡å— ,åˆ™ä¸ç”¨å†æ¬¡æ·»åŠ </p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron url  http://ctl01:9696  #æ­¤æ¡å®˜æ–¹æ–‡æ¡£æœªæ·»åŠ </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron auth_url  http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron auth_type  password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron project_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron user_domain_name  default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron region_name  RegionOne</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron project_name  service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron username  neutron</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron password  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron service_metadata_proxy  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/nova/nova.conf neutron metadata_proxy_shared_secret  Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åœ¨ctl01æ§åˆ¶èŠ‚ç‚¹ä¸Šé‡æ–°å¯åŠ¨nova APIè®¡ç®—æœåŠ¡</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-nova-api.service</span></span></code></pre></figure>
<p>å›åˆ°ç½‘ç»œèŠ‚ç‚¹å¯åŠ¨neutronæœåŠ¡å’Œé…ç½®å¼€æœºå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable neutron-server.service neutron-linuxbridge-agent.service neutron-dhcp-agent.service neutron-metadata-agent.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart neutron-server.service neutron-linuxbridge-agent.service neutron-dhcp-agent.service neutron-metadata-agent.service</span></span></code></pre></figure>
<p>å› é…ç½®äº†ç¬¬3å±‚l3ç½‘ç»œæœåŠ¡ éœ€è¦å¯åŠ¨ç¬¬ä¸‰å±‚æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable neutron-l3-agent.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart neutron-l3-agent.service</span></span></code></pre></figure>
<p>å¯ä»¥åˆ°æ§åˆ¶èŠ‚ç‚¹å†æ¬¡éªŒè¯Neutronç½‘ç»œæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ—å‡ºå·²åŠ è½½çš„æ‰©å±•ï¼Œä»¥éªŒè¯è¯¥neutron-serverè¿‡ç¨‹æ˜¯å¦æˆåŠŸå¯åŠ¨</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> extension list --network</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ—å‡ºä»£ç†å•†ä»¥éªŒè¯æˆåŠŸ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network agent list</span></span></code></pre></figure>
<h3 id="horizon"><strong>Horizon</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#horizon" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šå®‰è£…horizon">åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šå®‰è£…horizon<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šå®‰è£…horizon" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>å®‰è£…è½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-dashboard</span></span></code></pre></figure>
<p>æ”¹é…ç½®æ–‡ä»¶/etc/openstack-dashboard/local_settings</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/openstack-dashboard/local_settings{,.bak}</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '^$|#'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/openstack-dashboard/local_settings.bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/openstack-dashboard/local_settings</span></span></code></pre></figure>
<p>åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šé…ç½®ä»ªè¡¨ç›˜ä»¥ä½¿ç”¨ OpenStack æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ctl01&quot;</span></span></code></pre></figure>
<p>å…è®¸æ‰€æœ‰ä¸»æœºè®¿é—®ä»ªè¡¨æ¿</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ALLOWED_HOSTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'*'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ]</span></span></code></pre></figure>
<p>é…ç½® memcached ä¼šè¯å­˜å‚¨æœåŠ¡ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SESSION_ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'django.contrib.sessions.backends.cache'</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CACHES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'default'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         'BACKEND'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'django.core.cache.backends.memcached.MemcachedCache'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         'LOCATION'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'ctl01:11211'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<p>å¯ç”¨ç¬¬3ç‰ˆè®¤è¯API</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5000/v3&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OPENSTACK_HOST</span></span></code></pre></figure>
<p>å¯ç”¨å¯¹åŸŸçš„æ”¯æŒ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span></code></pre></figure>
<p>é…ç½®APIç‰ˆæœ¬</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_API_VERSIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;identity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;image&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<p>é€šè¿‡ä»ªè¡¨ç›˜åˆ›å»ºç”¨æˆ·æ—¶çš„é»˜è®¤åŸŸé…ç½®ä¸º default</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_DEFAULT_DOMAIN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;default&quot;</span></span></code></pre></figure>
<p>é€šè¿‡ä»ªè¡¨ç›˜åˆ›å»ºçš„ç”¨æˆ·é»˜è®¤è§’è‰²é…ç½®ä¸º user</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_DEFAULT_ROLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user&quot;</span></span></code></pre></figure>
<p>å¦‚æœæ‚¨é€‰æ‹©ç½‘ç»œå‚æ•°1ï¼Œç¦ç”¨æ”¯æŒ3å±‚ç½‘ç»œæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_NEUTRON_NETWORK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ...</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_router'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_quotas'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_distributed_router'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_ha_router'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_lb'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_firewall'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_vpn'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_fip_topology_check'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<p>å¯ä»¥é€‰æ‹©æ€§åœ°é…ç½®æ—¶åŒº</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TIME_ZONE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Asia/Shanghai&quot;</span></span></code></pre></figure>
<p>å…¨éƒ¨é…ç½®è¯´æ˜</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">etc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">openstack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dashboard</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">local_settings</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®ä»ªè¡¨ç›˜åœ¨ctl01èŠ‚ç‚¹ä¸Šä½¿ç”¨OpenStackæœåŠ¡</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ctl01&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…è®¸ä¸»æœºè®¿é—®ä»ªè¡¨æ¿,æ¥å—æ‰€æœ‰ä¸»æœº,ä¸å®‰å…¨ä¸åº”åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ALLOWED_HOSTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'*'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ALLOWED_HOSTS = ['one.example.com', 'two.example.com']</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®memcachedä¼šè¯å­˜å‚¨æœåŠ¡</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SESSION_ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'django.contrib.sessions.backends.cache'</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CACHES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'default'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         'BACKEND'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'django.core.cache.backends.memcached.MemcachedCache'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         'LOCATION'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'ctl01:11211'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯ç”¨èº«ä»½APIç‰ˆæœ¬3</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5000/v3&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OPENSTACK_HOST</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯ç”¨å¯¹åŸŸçš„æ”¯æŒ</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®APIç‰ˆæœ¬</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_API_VERSIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;identity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;image&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®Defaultä¸ºé€šè¿‡ä»ªè¡¨æ¿åˆ›å»ºçš„ç”¨æˆ·çš„é»˜è®¤åŸŸ</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_DEFAULT_DOMAIN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Default&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®userä¸ºé€šè¿‡ä»ªè¡¨æ¿åˆ›å»ºçš„ç”¨æˆ·çš„é»˜è®¤è§’è‰²</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_KEYSTONE_DEFAULT_ROLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¦‚æœé€‰æ‹©ç½‘ç»œé€‰é¡¹1ï¼Œè¯·ç¦ç”¨å¯¹ç¬¬3å±‚ç½‘ç»œæœåŠ¡çš„æ”¯æŒ,å¦‚æœé€‰æ‹©ç½‘ç»œé€‰é¡¹2,åˆ™å¯ä»¥æ‰“å¼€</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPENSTACK_NEUTRON_NETWORK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è‡ªåŠ¨åˆ†é…çš„ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_auto_allocated_network'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Neutronåˆ†å¸ƒå¼è™šæ‹Ÿè·¯ç”±å™¨ï¼ˆDVRï¼‰</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_distributed_router'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># FIPæ‹“æ‰‘æ£€æŸ¥</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_fip_topology_check'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é«˜å¯ç”¨è·¯ç”±å™¨æ¨¡å¼</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_ha_router'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸‹é¢ä¸‰ä¸ªå·²è¿‡æ—¶,ä¸ç”¨è¿‡å¤šäº†è§£,å®˜æ–¹æ–‡æ¡£é…ç½®ä¸­æ˜¯å…³é—­çš„</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_lb'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_firewall'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_vpn'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ipv6ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_ipv6'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Neutroné…é¢åŠŸèƒ½</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_quotas'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># rbacæ”¿ç­–</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_rbac_policy'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è·¯ç”±å™¨çš„èœå•å’Œæµ®åŠ¨IPåŠŸèƒ½,å¦‚æœNeutronéƒ¨ç½²æœ‰ä¸‰å±‚åŠŸèƒ½çš„æ”¯æŒå¯ä»¥æ‰“å¼€</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'enable_router'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é»˜è®¤çš„DNSåç§°æœåŠ¡å™¨</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'default_dns_nameservers'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç½‘ç»œæ”¯æŒçš„æä¾›è€…ç±»å‹,åœ¨åˆ›å»ºç½‘ç»œæ—¶ï¼Œè¯¥åˆ—è¡¨ä¸­çš„ç½‘ç»œç±»å‹å¯ä¾›é€‰æ‹©</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'supported_provider_types'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'*'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ä¸æä¾›ç½‘ç»œIDèŒƒå›´,ä»…æ¶‰åŠåˆ°VLANï¼ŒGREï¼Œå’ŒVXLANç½‘ç»œç±»å‹</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'segmentation_id_range'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {},</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ä¸æä¾›ç½‘ç»œç±»å‹</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    'extra_provider_types'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {},</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ”¯æŒçš„vnicç±»å‹,ç”¨äºä¸ç«¯å£ç»‘å®šæ‰©å±•</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 'supported_vnic_types': ['*'],</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç‰©ç†ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 'physical_networks': [],</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®æ—¶åŒºä¸ºäºšæ´²ä¸Šæµ·</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TIME_ZONE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Asia/Shanghai&quot;</span></span></code></pre></figure>
<p>é‡å»ºapacheçš„dashboardé…ç½®æ–‡ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/openstack-dashboard</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> manage.py make_web_conf --apache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/httpd/conf.d/openstack-dashboard.conf</span></span></code></pre></figure>
<p>é‡æ–°å¯åŠ¨èŠ‚ç‚¹ä¸Šçš„apacheæœåŠ¡å’ŒmemcacheæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart httpd.service memcached.service</span></span></code></pre></figure>
<p>è®¿é—®dashboard</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http://10.191.101.128</span></span></code></pre></figure>
<p>è‹¥ä¸èƒ½æ­£å¸¸è®¿é—®ï¼Œè¯·æ“ä½œä»¥ä¸‹æ­¥éª¤:å»ºç«‹ç­–ç•¥æ–‡ä»¶ï¼ˆpolicy.jsonï¼‰çš„è½¯é“¾æ¥ï¼Œå¦åˆ™ç™»å½•åˆ°dashboardå°†å‡ºç°æƒé™é”™è¯¯å’Œæ˜¾ç¤ºæ··ä¹±</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/openstack-dashboard /usr/share/openstack-dashboard/openstack_dashboard/conf</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/httpd/conf.d/openstack-dashboard.conf å¦‚æœæœªåŒ…å«ï¼Œåˆ™æ·»åŠ ä»¥ä¸‹è¡Œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WSGIApplicationGroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %{GLOBAL}</span></span></code></pre></figure>
<h4 id="èº«ä»½è®¤è¯dashboardæ— æ³•æ‰“å¼€">èº«ä»½è®¤è¯dashboardæ— æ³•æ‰“å¼€<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#èº«ä»½è®¤è¯dashboardæ— æ³•æ‰“å¼€" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/httpd/conf.d/openstack-dashboard.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å°†åŸæœ‰çš„é…ç½®æ³¨é‡Šæ‰</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#WSGIScriptAlias / /usr/share/openstack-dashboard/openstack_dashboard/wsgi.py</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Alias /static /usr/share/openstack-dashboard/static</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ ä»¥ä¸‹é…ç½®</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WSGIScriptAlias</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dashboard /usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Alias</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dashboard/static /usr/share/openstack-dashboard/static</span></span></code></pre></figure>
<p>åœ¨local_settingsåº•ä¸‹æ–°å¢æ ¹ç›®å½•æŒ‡å‘</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/openstack-dashboard/local_settings</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WEBROOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = '/dashboard/'</span></span></code></pre></figure>
<p>ç¼–è¾‘ä»¥ä¸‹æ–‡ä»¶ï¼Œæ‰¾åˆ°WEBROOT = â€™/â€™ ä¿®æ”¹ä¸ºWEBROOT = â€˜/dashboardâ€™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/openstack-dashboard/openstack_dashboard/defaults.py</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/openstack-dashboard/openstack_dashboard/test/settings.py</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/openstack-dashboard/static/dashboard/js/xxxx.js</span></span></code></pre></figure>
<p>ä¿®æ”¹åé‡å¯æœåŠ¡å³å¯</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart httpd.service memcached.service</span></span></code></pre></figure>
<h3 id="cinder"><strong>Cinder</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cinder" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="æ§åˆ¶èŠ‚ç‚¹é…ç½®"><strong>æ§åˆ¶èŠ‚ç‚¹é…ç½®</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#æ§åˆ¶èŠ‚ç‚¹é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åœ¨æ§åˆ¶èŠ‚ç‚¹ï¼ˆctl01ï¼š10.191.101.128ï¼‰ä¸Šé…ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">root</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p</span></span></code></pre></figure>
<p>åˆ›å»ºæ•°æ®åº“å¹¶æˆæƒ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cinder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cinder.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'cinder'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cinder.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'cinder'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Abc-1234'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flush privileges;</span></span></code></pre></figure>
<p>åˆ›å»ºcinderç”¨æˆ·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user create --domain default --password Abc-1234 cinder</span></span></code></pre></figure>
<p>èµ‹äºˆCinderæƒé™ä¸ºadmin</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role add --project service --user cinder admin</span></span></code></pre></figure>
<p>åˆ›å»º cinderæœåŠ¡å®ä½“</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service create --name cinderv2 --description &quot;OpenStack Block Storage&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volumev2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service create --name cinderv3 --description &quot;OpenStack Block Storage&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volumev3</span></span></code></pre></figure>
<p>åˆ›å»ºå—è®¾å¤‡å­˜å‚¨æœåŠ¡çš„ API å…¥å£ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne volumev2 public http://ctl01:8776/v2/%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne volumev2 internal http://ctl01:8776/v2/%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne volumev2 admin http://ctl01:8776/v2/%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne volumev3 public http://ctl01:8776/v3/%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne volumev3 internal http://ctl01:8776/v3/%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endpoint create --region RegionOne volumev3 admin http://ctl01:8776/v3/%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s</span></span></code></pre></figure>
<p>å®‰è£…è½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install -y openstack-cinder</span></span></code></pre></figure>
<p>cinderé…ç½®æ–‡ä»¶/etc/cinder/cinder.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf DEFAULT rpc_backend rabbit</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf DEFAULT auth_strategy keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf DEFAULT my_ip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.128</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf DEFAULT transport_url  rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf database connection mysql+pymysql://cinder:Abc-1234@ctl01/cinder</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_hosts ctl01:5672</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_userid openstack</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf oslo_messaging_rabbit rabbit_password 'Abc-1234'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken auth_url http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken www_authenticate_uri http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken memcached_servers ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken project_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken user_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken username cinder</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf keystone_authtoken password 'Abc-1234'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf oslo_concurrency lock_path /var/lib/cinder/tmp</span></span></code></pre></figure>
<p>åˆå§‹åŒ–å—è®¾å¤‡æœåŠ¡çš„æ•°æ®åº“ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sh -c &quot;cinder-manage db sync&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cinder</span></span></code></pre></figure>
<p>é…ç½®è®¡ç®—æœåŠ¡ä»¥ä½¿ç”¨å—è®¾å¤‡å­˜å‚¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nova/nova.conf cinder os_region_name RegionOne</span></span></code></pre></figure>
<p>é‡å¯novaè®¡ç®—å’Œcinderå—å­˜å‚¨æœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-nova-api.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-cinder-api.service openstack-cinder-scheduler.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable openstack-cinder-api.service openstack-cinder-scheduler.service</span></span></code></pre></figure>
<h4 id="å­˜å‚¨èŠ‚ç‚¹é…ç½®">å­˜å‚¨èŠ‚ç‚¹é…ç½®<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å­˜å‚¨èŠ‚ç‚¹é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åœ¨æ§åˆ¶èŠ‚ç‚¹ï¼ˆcinder01ï¼š10.191.101.131ï¼‰ä¸Šé…ç½®</p>
<p>å®‰è£…LVMè½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install -y lvm2 device-mapper-persistent-data</span></span></code></pre></figure>
<p>å¯åŠ¨LVMå…ƒæ•°æ®æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable lvm2-lvmetad.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart lvm2-lvmetad.service</span></span></code></pre></figure>
<p>æ·»åŠ ä¸€å—100Gç¡¬ç›˜ï¼Œé‡å¯èŠ‚ç‚¹ååˆ›å»ºLVMç‰©ç†å·/dev/sdb</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pvcreate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span></span></code></pre></figure>
<p>åˆ›å»ºLVMç‰©ç†å·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vgcreate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cinder-volumes /dev/sdb</span></span></code></pre></figure>
<p>ç¼–è¾‘é…ç½®æ–‡ä»¶/etc/lvm/lvm.conf,åœ¨deviceséƒ¨åˆ†ï¼Œæ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œåªæ¥å—/dev/sdbè®¾å¤‡ï¼Œæ‹’ç»å…¶ä»–æ‰€æœ‰è®¾å¤‡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/lvm/lvm.conf</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">devices</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = [ &quot;a/sdb/&quot;, &quot;r/.*/&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ]</span></span></code></pre></figure>
<p>å®‰è£…trainç‰ˆyumæºå’Œcinderè½¯ä»¶åŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install centos-release-openstack-train</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install openstack-cinder targetcli python-keystone openstack-utils</span></span></code></pre></figure>
<p>ç¼–è¾‘é…ç½®æ–‡ä»¶/etc/cinder/cinder.conf</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf /etc/cinder/cinder.conf.bak</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '#|^$'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf.ba</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/cinder/cinder.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">my_ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.131</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  database  connection mysql+pymysql://cinder:Abc-1234@ctl01/cinder</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  DEFAULT transport_url rabbit://openstack:Abc-1234@ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  DEFAULT auth_strategy keystone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  DEFAULT my_ip &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$my_ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  DEFAULT enabled_backends lvm</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  DEFAULT glance_api_servers http://ctl01:9292</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken www_authenticate_uri http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken auth_url http://ctl01:5000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken memcached_servers ctl01:11211</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken auth_type password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken project_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken user_domain_name default</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken project_name service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken username cinder</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  keystone_authtoken password Abc-1234</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  lvm volume_driver cinder.volume.drivers.lvm.LVMVolumeDriver</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  lvm volume_group cinder-volumes</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  lvm target_protocol iscsi</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  lvm target_helper lioadm</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack-config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf  oslo_concurrency lock_path /var/lib/cinder/tmp</span></span></code></pre></figure>
<p>å¯åŠ¨å—å­˜å‚¨å·æœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-cinder-volume.service target.service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable openstack-cinder-volume.service target.service</span></span></code></pre></figure>
<p>åœ¨æ§åˆ¶èŠ‚ç‚¹éªŒè¯æœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume service list</span></span></code></pre></figure>
<p>åœ¨dashboardæŸ¥çœ‹
<img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225823.png" width="auto" height="auto" alt/></p>
<p>åˆ›å»ºå·æµ‹è¯•
<img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225838.png" width="auto" height="auto" alt/></p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225852.png" width="auto" height="auto" alt/></p>
<h1 id="openstackä½¿ç”¨"><strong>Openstackä½¿ç”¨</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#openstackä½¿ç”¨" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>ä»cirrosé•œåƒåˆ›å»ºå·æµ‹è¯•åˆ›å»ºè™šæ‹Ÿæœº
<img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225916.png" width="auto" height="auto" alt/></p>
<p>åˆ›å»ºå®ä¾‹ç±»å‹
<img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225929.png" width="auto" height="auto" alt/></p>
<h2 id="å»ºç«‹å…¬å…±æä¾›å•†ç½‘ç»œ"><strong>å»ºç«‹å…¬å…±æä¾›å•†ç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å»ºç«‹å…¬å…±æä¾›å•†ç½‘ç»œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="åˆ›å»ºç½‘ç»œ"><strong>åˆ›å»ºç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºç½‘ç»œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>åœ¨adminç®¡ç†å‘˜ä¸‹åˆ›å»º</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network create --share --external --provider-physical-network provider --provider-network-type flat provider</span></span></code></pre></figure>
<p>å‚æ•°ç†è§£ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--share</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å…è®¸æ‰€æœ‰é¡¹ç›®ä½¿ç”¨è™šæ‹Ÿç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--external</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> å°†è™šæ‹Ÿç½‘ç»œå®šä¹‰ä¸ºå¤–éƒ¨,å¦‚æœæƒ³åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç½‘ç»œï¼Œåˆ™å¯ä»¥ä½¿ç”¨--internalã€‚é»˜è®¤å€¼ä¸ºinternal</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--provider-physical-network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> provider</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æŒ‡æ˜ç‰©ç†ç½‘ç»œçš„æä¾›è€…ï¼Œprovider ä¸ä¸‹é¢neutronçš„é…ç½®æ–‡ä»¶å¯¹åº”ï¼Œå…¶ä¸­provideræ˜¯æ ‡ç­¾ï¼Œå¯ä»¥æ›´æ”¹ä¸ºå…¶ä»–ï¼Œä½†æ˜¯2ä¸ªåœ°æ–¹å¿…é¡»è¦ç»Ÿä¸€</span></span>
<span data-line> </span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®æ–‡ä»¶/etc/neutron/plugins/ml2/ml2_conf.iniä¸­çš„å‚æ•°</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ml2_type_flat]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">flat_networks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = provider</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[linux_bridge]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">physical_interface_mappings</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = provider:ens33</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--provider-network-type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flat æŒ‡æ˜è¿™é‡Œåˆ›å»ºçš„ç½‘ç»œæ˜¯flatç±»å‹ï¼Œå³å®ä¾‹è¿æ¥åˆ°æ­¤ç½‘ç»œæ—¶å’Œç‰©ç†ç½‘ç»œæ˜¯åœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œæ— vlanç­‰åŠŸèƒ½ã€‚</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">æœ€åè¾“å…¥çš„provider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> æŒ‡å®šç½‘ç»œçš„åç§°</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="åˆ›å»ºå­ç½‘"><strong>åˆ›å»ºå­ç½‘</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºå­ç½‘" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>åœ¨ç½‘ç»œä¸Šåˆ›å»ºä¸€ä¸ªå­ç½‘ 10.191.101.0/24 ; å­ç½‘å¯¹åº”çœŸå®çš„ç‰©ç†ç½‘ç»œ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subnet create --network provider </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --allocation-pool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.10,end=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.20 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --dns-nameserver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2 --gateway </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --subnet-range</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.0/24 provider</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‚æ•°è§£é‡Š:</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> provider æŒ‡å®šçˆ¶ç½‘ç»œ</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--allocation-pool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.10,end=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.20 æŒ‡å®šå­ç½‘çš„èµ·å§‹åœ°å€å’Œç»ˆæ­¢åœ°å€</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--dns-nameserver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2 æŒ‡å®šDNSæœåŠ¡å™¨åœ°å€</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--gateway</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2 æŒ‡å®šç½‘å…³åœ°å€</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--subnet-range</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.0/24 æŒ‡å®šå­ç½‘çš„ç½‘æ®µ</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">æœ€åçš„provider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> æŒ‡å®šå­ç½‘çš„åç§°</span></span></code></pre></figure>
<p>åˆ›å»ºå®ä¾‹</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114225946.png" width="auto" height="auto" alt/></p>
<p>æµ‹è¯•ç½‘ç»œ
<img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114230001.png" width="auto" height="auto" alt/></p>
<h2 id="å»ºç«‹æ™®é€šç§Ÿæˆ·çš„ç§æœ‰è‡ªåŠ©æœåŠ¡ç½‘ç»œ"><strong>å»ºç«‹æ™®é€šç§Ÿæˆ·çš„ç§æœ‰è‡ªåŠ©æœåŠ¡ç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å»ºç«‹æ™®é€šç§Ÿæˆ·çš„ç§æœ‰è‡ªåŠ©æœåŠ¡ç½‘ç»œ" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="åˆ›å»ºç½‘ç»œ-1"><strong>åˆ›å»ºç½‘ç»œ</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºç½‘ç»œ-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>è‡ªåŠ©æœåŠ¡ç½‘ç»œï¼Œä¹Ÿå«ç§Ÿæˆ·ç½‘ç»œæˆ–é¡¹ç›®ç½‘ç»œï¼Œå®ƒæ˜¯ç”±openstackç§Ÿæˆ·åˆ›å»ºçš„ï¼Œå®Œå…¨è™šæ‹Ÿçš„ï¼Œæ˜¯ç§Ÿæˆ·ç§æœ‰çš„ï¼Œåªåœ¨æœ¬ç½‘ç»œå†…éƒ¨è¿é€šï¼Œä¸èƒ½åœ¨ç§Ÿæˆ·ä¹‹é—´å…±äº«</p>
<p>åœ¨æ™®é€šç§Ÿæˆ·ä¸‹åˆ›å»ºç½‘ç»œï¼Œå½“å‰ä½¿ç”¨è´¦å·myuserï¼Œé‡ç½®å¯†ç ä¸ºAbc-1234</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114230131.png" width="auto" height="auto" alt/></p>
<p>éç‰¹æƒç”¨æˆ·é€šå¸¸æ— æ³•ä¸ºè¯¥å‘½ä»¤æä¾›å…¶ä»–å‚æ•°ï¼Œè¯¥æœåŠ¡ä½¿ç”¨ä»¥ä¸‹é…ç½®æ–‡ä»¶ä¸­çš„ä¿¡æ¯è‡ªåŠ¨é€‰æ‹©å‚æ•°</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/neutron/plugins/ml2/ml2_conf.ini</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ml2]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">type_drivers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = flat,vlan,vxlan</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tenant_network_types</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = vxlan</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ml2_type_vxlan]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vni_ranges</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:1000</span></span></code></pre></figure>
<h3 id="åˆ›å»ºå­ç½‘-1"><strong>åˆ›å»ºå­ç½‘</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºå­ç½‘-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>åˆ›å»ºä¸€ä¸ªå­ç½‘ 172.18.1.0/24</p>
<p><img src="../äº‘è®¡ç®—å’Œè™šæ‹ŸåŒ–/attachments/Pasted-image-20240114230157.png" width="auto" height="auto" alt/></p>
<h3 id="åˆ›å»ºè·¯ç”±"><strong>åˆ›å»ºè·¯ç”±</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#åˆ›å»ºè·¯ç”±" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>ä½¿ç”¨å‘½ä»¤åˆ›å»ºï¼Œé…ç½®myuserç¯å¢ƒå˜é‡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myuser-openrc</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_USERNAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">myuser</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_PASSWORD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Abc-1234</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_PROJECT_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">myproject</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_USER_DOMAIN_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Default</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_PROJECT_DOMAIN_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Default</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_AUTH_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://ctl01:5000/v3</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OS_IDENTITY_API_VERSION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span></code></pre></figure>
<p>æŸ¥çœ‹å·²åˆ›å»ºçš„ç½‘ç»œ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network list</span></span></code></pre></figure>
<p>æŸ¥çœ‹å·²åˆ›å»ºçš„å­ç½‘</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subnet list</span></span></code></pre></figure>
<p>åˆ›å»ºè·¯ç”±å™¨ï¼Œç”¨myuseræ™®é€šç§Ÿæˆ·åˆ›å»º</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/myuser-openrc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> router create router01</span></span></code></pre></figure>
<p>æŸ¥çœ‹åˆ›å»ºçš„è·¯ç”±</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> router list</span></span></code></pre></figure>
<p>å°†åˆ›å»ºçš„ç§Ÿæˆ·è‡ªåŠ©æœåŠ¡ç½‘ç»œå­ç½‘æ·»åŠ ä¸ºè·¯ç”±å™¨ä¸Šçš„æ¥å£</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> router add subnet router01 selfservice</span></span></code></pre></figure>
<p>åœ¨è·¯ç”±å™¨çš„å…¬å…±æä¾›å•†ç½‘ç»œä¸Šè®¾ç½®ç½‘å…³</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> router set router01 --external-gateway provider</span></span></code></pre></figure>
<h3 id="ip-nets"><strong>Ip nets</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ip-nets" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ctl01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ip netns</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">qrouter-7962017d-fd01-4863-aae0-329fd704bc78</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">qdhcp-28e70282-9aff-4048-8e17-9a2879f9eab2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ip netnså‘½ä»¤æ‰¾åˆ°è¿™ä¸ªè™šæ‹Ÿè·¯ç”±å™¨ä¹‹åï¼Œç”¨è¿™ä¸ªè™šæ‹Ÿè·¯ç”±å™¨pingçœŸå®ç‰©ç†ç½‘ç»œä¸­çš„ç½‘å…³ï¼Œpingé€šå³è¯æ˜OpenStackå†…éƒ¨è™šæ‹Ÿç½‘ç»œä¸çœŸå®ç‰©ç†ç½‘ç»œè¡”æ¥æˆåŠŸ</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ctl01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ip netns</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">qrouter-7962017d-fd01-4863-aae0-329fd704bc78</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">qdhcp-28e70282-9aff-4048-8e17-9a2879f9eab2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ctl01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ip netns exec qrouter-7962017d-fd01-4863-aae0-329fd704bc78 ping 10.191.101.2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2 </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.191.101.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">56</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">bytes of data.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes from </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2: icmp_seq=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ttl=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.663</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ms</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes from </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.191</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.101.2: icmp_seq=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ttl=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.235</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ms</span></span></code></pre></figure>
<p>éªŒè¯æŸ¥çœ‹åˆ›å»ºç½‘ç»œå’Œå­ç½‘ä¸­çš„IPåœ°å€èŒƒå›´ï¼Œå›åˆ°adminç”¨æˆ·ä¸‹</p>
<p>åˆ—å‡ºè·¯ç”±å™¨ä¸Šçš„ç«¯å£ï¼Œä»¥ç¡®å®šæä¾›å•†ç½‘ç»œä¸Šçš„ç½‘å…³IPåœ°å€</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port list --router router01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+--------------------------------------+------+-------------------+------------------------------------------------------------------------------+--------+</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                                   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address       </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Fixed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP Addresses                                                           </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+--------------------------------------+------+-------------------+------------------------------------------------------------------------------+--------+</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 2cfa2e4b-3b57-4aa3-af77-59eca94242eb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fa:16:3e:56:7f:9a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ip_address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'172.18.1.1', subnet_id='1213f505-8e0d-4b5e-b7b9-f659aaf92486'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ACTIVE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> be99fadb-47fd-4247-b504-baf00d810f8d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fa:16:3e:8e:1a:4d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ip_address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'10.191.101.13', subnet_id='4f7508fd-b250-44b8-be9c-f2d840abd852'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ACTIVE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+--------------------------------------+------+-------------------+------------------------------------------------------------------------------+--------+</span></span></code></pre></figure>
<h1 id="cephå®‰è£…"><strong>Cephå®‰è£…</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cephå®‰è£…" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>èŠ‚ç‚¹è§„åˆ’ï¼šå•èŠ‚ç‚¹</p>



















<div class="table-container"><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>ceph01ï¼ˆå¯é€‰ï¼‰</td><td>cephå•èŠ‚ç‚¹</td><td>10.191.101.140/24</td><td>192.168.80.140/24</td><td>1C2G</td></tr></tbody></table></div>
<p>ç³»ç»Ÿç‰ˆæœ¬</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/redhat-release</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CentOS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux release </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7.6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.1810 </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Core</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>è‡ªåŠ¨è¡¥å…¨</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install -y bash-completion</span></span></code></pre></figure>
<p>ä¸»æœºå</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostnamectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-hostname ceph01</span></span></code></pre></figure>
<p>Yumé…ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/yum.repos.d/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -rf</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://mirrors.aliyun.com/repo/Centos-7.repo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/yum.repos.d/Centos-7.repo</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://mirrors.aliyun.com/repo/epel-7.repo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/yum.repos.d/epel.repo</span></span></code></pre></figure>
<p>Ceph yumæº</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /etc/yum.repos.d/ceph.repo</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Ceph]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Ceph packages for </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$basearch</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseurl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://download.ceph.com/rpm-mimic/el7/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$basearch</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgcheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rpm-md</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgkey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://download.ceph.com/keys/release.asc</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">priority</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Ceph-noarch]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Ceph noarch packages</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseurl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://download.ceph.com/rpm-mimic/el7/noarch</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgcheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rpm-md</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgkey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://download.ceph.com/keys/release.asc</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">priority</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ceph-source]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Ceph source packages</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseurl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://download.ceph.com/rpm-mimic/el7/SRPMS</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgcheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rpm-md</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpgkey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://download.ceph.com/keys/release.asc</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">priority</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></figure>
<p>Hostsé…ç½®ï¼ˆå¯¹æ¥openstackï¼ŒåŒæ­¥æ·»åŠ openstackèŠ‚ç‚¹ï¼‰</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostnamectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-hostname ceph01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hosts </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&lt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">â€˜EOFâ€™</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.191.101.140</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOSTNAME</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.191.101.128</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ctl01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.191.101.129</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.191.101.130</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> neutron01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.191.101.131</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cinder01</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EOF</span></span></code></pre></figure>
<p>å…³é—­selinuxå’Œé˜²ç«å¢™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setenforce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 's/SELINUX=.*/SELINUX=disabled/'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/selinux/config</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop firewalld</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable firewalld</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mask firewalld</span></span></code></pre></figure>
<p>å®‰è£…è½¯ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clean all </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> makecache</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install ceph-deploy epel-release python-pip ceph ceph-radosgw chrony   </span></span></code></pre></figure>
<p>éƒ¨ç½²cephé›†ç¾¤</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/ceph/</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph-deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOSTNAME</span></span></code></pre></figure>
<p>å•èŠ‚ç‚¹é…ç½®éœ€è¦ä¿®æ”¹é…ç½®</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/ceph/ceph.conf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EOF</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">osd pool default size = 1</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">osd crush chooseleaf type = 0</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">osd max object name len = 256</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">osd journal size = 128</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></figure>
<p>å®‰è£…cephèŠ‚ç‚¹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CEPH_DEPLOY_REPO_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://mirrors.aliyun.com/ceph/rpm-nautilus/el7/</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CEPH_DEPLOY_GPG_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://mirrors.aliyun.com/ceph/keys/release.asc</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph-deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOSTNAME</span></span></code></pre></figure>
<p>æŸ¥çœ‹ç‰ˆæœ¬</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --version</span></span></code></pre></figure>
<p>ä½¿ç”¨ceph-deployè¿›è¡Œéƒ¨ç½²ï¼Œåœ¨æ›´æ–°çš„ç‰ˆæœ¬ä¸­ï¼Œè¯¥å·¥å…·å·²è¢«å¼ƒç”¨
åˆå§‹åŒ–ç›‘è§†èŠ‚ç‚¹å’ŒåŒæ­¥æ‰€æœ‰é…ç½®æ–‡ä»¶åˆ° /etc/ceph/ ä¸‹</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph-deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon create-initial</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph-deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOSTNAME</span></span></code></pre></figure>
<p>èŠ‚ç‚¹ä¸‹åˆ›å»ºmanager</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph-deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mgr create </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOSTNAME</span></span></code></pre></figure>
<p>æ·»åŠ osd</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph-deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd create --data /dev/sdX </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOSTNAME</span></span></code></pre></figure>
<p>éƒ¨ç½²å®Œæˆï¼Œæ£€æŸ¥å•èŠ‚ç‚¹cephéƒ¨ç½²æƒ…å†µ</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span></span></code></pre></figure>
<h3 id="dashboardé…ç½®">Dashboardé…ç½®<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dashboardé…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>åœ¨æ¯ä¸ªmgrèŠ‚ç‚¹å®‰è£…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install ceph-mgr-dashboard</span></span></code></pre></figure>
<p>å¼€å¯mgråŠŸèƒ½</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mgr module enable dashboard</span></span></code></pre></figure>
<p>ç”Ÿæˆå¹¶å®‰è£…è‡ªç­¾åçš„è¯ä¹¦</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dashboard create-self-signed-cert</span></span></code></pre></figure>
<p>åˆ›å»ºä¸€ä¸ªdashboardç™»å½•ç”¨æˆ·åå¯†ç </p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯†ç å†™å…¥æ–‡ä»¶ä¸­ï¼Œå‘½ä»¤è¡Œä»æ–‡ä»¶ä¸­è¯»å…¥å¯†ç </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph dashboard ac-user-create guest -i ceph-passwd.txt  administrator</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;username&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;guest&quot;, &quot;lastUpdate&quot;: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1702966284</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, &quot;name&quot;: null, &quot;roles&quot;: [&quot;administrator&quot;], &quot;password&quot;: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$2b$12$qKgRIUT1xz41kJjeUqsQm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.h.ktyN.QA4981Kw5OUoY1Ea.uCuRAA2&quot;, &quot;email&quot;: null}</span></span></code></pre></figure>
<p>æŸ¥çœ‹æœåŠ¡è®¿é—®æ–¹å¼</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph mgr services</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    &quot;dashboard&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://ceph01:8443/&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è‹¥æœªé…ç½®åŸŸåè§£æåˆ™é€šè¿‡ipè®¿é—®</span></span></code></pre></figure>
<h3 id="cephå¸¸ç”¨å‘½ä»¤">Cephå¸¸ç”¨å‘½ä»¤<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cephå¸¸ç”¨å‘½ä»¤" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="osdç»´æŠ¤å‘½ä»¤">OSDç»´æŠ¤å‘½ä»¤<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#osdç»´æŠ¤å‘½ä»¤" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤ºCephé›†ç¾¤ä¸­çš„OSDæ ‘ï¼ŒåŒ…æ‹¬æ¯ä¸ªOSDçš„çŠ¶æ€å’Œä½ç½®</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd tree</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤ºCephé›†ç¾¤ä¸­çš„OSDçŠ¶æ€æ‘˜è¦ä¿¡æ¯</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd stat</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤ºCephé›†ç¾¤ä¸­çš„æ‰€æœ‰pool</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd pool ls</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤ºpoolä¸­è¯¦ç»†çš„volumeä¿¡æ¯</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rbd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --pool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pool_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å°†æŒ‡å®šçš„OSDæ ‡è®°ä¸ºâ€œç¦»çº¿â€ï¼Œä»é›†ç¾¤ä¸­æ’é™¤</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd out </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">osd-i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å°†æŒ‡å®šçš„OSDæ ‡è®°ä¸ºâ€œåœ¨çº¿â€ï¼Œé‡æ–°åŠ å…¥é›†ç¾¤</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd in </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">osd-i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸ºå­˜å‚¨æ± è®¾ç½®å‰¯æœ¬å¤§å°</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd pool set </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pool_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">replica_siz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span></code></pre></figure>
<h4 id="monitorç»´æŠ¤å‘½ä»¤">Monitorç»´æŠ¤å‘½ä»¤<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#monitorç»´æŠ¤å‘½ä»¤" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤ºCephé›†ç¾¤ä¸­ç›‘è§†å™¨çš„çŠ¶æ€ä¿¡æ¯</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon stat</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¾ç¤ºCephé›†ç¾¤ä¸­ç›‘è§†å™¨çš„è¯¦ç»†ä¿¡æ¯</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon dump</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»Cephé›†ç¾¤ä¸­ç§»é™¤æŒ‡å®šçš„ç›‘è§†å™¨</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon remove </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mon-i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span></code></pre></figure>
<h4 id="pgç»´æŠ¤å‘½ä»¤">PGç»´æŠ¤å‘½ä»¤<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#pgç»´æŠ¤å‘½ä»¤" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<pre><code># æ˜¾ç¤ºCephé›†ç¾¤ä¸­PGï¼ˆplacement groupï¼‰çš„çŠ¶æ€ä¿¡æ¯
ceph pg stat

# ä¿®å¤æŒ‡å®šçš„PGï¼Œè§£å†³å¯èƒ½çš„ä¸€è‡´æ€§é—®é¢˜
ceph pg repair &lt;pg-id>

# å¯¹æŒ‡å®šçš„PGæ‰§è¡Œâ€œscrubâ€æ“ä½œï¼Œæ£€æŸ¥å’Œä¿®å¤æ•°æ®
ceph pg scrub &lt;pg-id>
</code></pre>
<h4 id="å¥åº·çŠ¶æ€å‘½ä»¤">å¥åº·çŠ¶æ€å‘½ä»¤<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å¥åº·çŠ¶æ€å‘½ä»¤" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<pre><code># æ£€æŸ¥Cephé›†ç¾¤çš„å¥åº·çŠ¶æ€
ceph health

# æ˜¾ç¤ºè¯¦ç»†çš„Cephé›†ç¾¤å¥åº·çŠ¶æ€ä¿¡æ¯
ceph health detail

# è¿è¡ŒæŒ‡å®šçš„å¥åº·æ£€æŸ¥
ceph health check &lt;check-name>
</code></pre>
<h4 id="ç®¡ç†cephé…ç½®æ–‡ä»¶">ç®¡ç†Cephé…ç½®æ–‡ä»¶<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ç®¡ç†cephé…ç½®æ–‡ä»¶" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<pre><code># æ˜¾ç¤ºCephé›†ç¾¤çš„é…ç½®ä¿¡æ¯
ceph config show

# è®¾ç½®æŒ‡å®šçš„Cephé…ç½®é¡¹
ceph config set &lt;key> &lt;value>

# è·å–æŒ‡å®šçš„Cephé…ç½®é¡¹çš„å€¼
ceph config get &lt;key>
</code></pre>
<h3 id="å¸¸è§å‘Šè­¦å¤„ç†">å¸¸è§å‘Šè­¦å¤„ç†<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å¸¸è§å‘Šè­¦å¤„ç†" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>1 monitors have not enabled msgr2</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon enable-msgr2</span></span></code></pre></figure>
<blockquote>
<p>msgr2æ˜¯Cephçš„æ–°æ¶ˆæ¯ä¼ è¾“åè®®ï¼Œå®ƒæä¾›äº†æ›´å¥½çš„æ€§èƒ½å’Œå®‰å…¨æ€§</p>
</blockquote>
<p>mon is allowing insecure global_id reclaim</p>
<pre><code># ç¦ç”¨ä¸å®‰å…¨æ¨¡å¼
 ceph config set mon auth_allow_insecure_global_id_reclaim false
</code></pre>
<blockquote>
<p>è¿™ä¸ªè­¦å‘Šè¡¨ç¤ºCephç›‘è§†å™¨æ­£åœ¨å…è®¸ä¸å®‰å…¨çš„å…¨å±€IDå›æ”¶ã€‚å…¨å±€IDæ˜¯Cephé›†ç¾¤ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºè¯†åˆ«å¯¹è±¡å’Œå…¶ä»–å…ƒæ•°æ®ã€‚ä¸å®‰å…¨çš„å…¨å±€IDå›æ”¶å¯èƒ½ä¼šå¯¼è‡´IDå†²çªå’Œæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜</p>
</blockquote>
<h3 id="å¯¹æ¥openstack">å¯¹æ¥OpenStack<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#å¯¹æ¥openstack" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<blockquote>
<p>é€šå¸¸ï¼ŒOpenStackæœ‰3ä¸ªåœ°æ–¹å¯ä»¥å’ŒCephå­˜å‚¨è¿›è¡Œå¯¹æ¥ï¼š
1ã€Imagesï¼šOpenStack çš„ Glance ç®¡ç†ç€ VM çš„ image ã€‚Image ç›¸å¯¹æ’å®šï¼ŒOpenStack æŠŠå®ƒä»¬å½“ä½œäºŒè¿›åˆ¶æ–‡ä»¶ã€å¹¶ä»¥æ­¤æ ¼å¼ä¸‹è½½ï¼›
2ã€Volumesï¼šOpenStack ç”¨ Cinder æœåŠ¡ç®¡ç† Volumes ã€‚Volume æ˜¯å—è®¾å¤‡ï¼ŒOpenStack ç”¨å®ƒä»¬å¼•å¯¼è™šæ‹Ÿæœºã€æˆ–æŒ‚è½½åˆ°è¿è¡Œä¸­çš„è™šæ‹Ÿæœºä¸Šï¼›
3ã€Guest Disks: Guest disks æ˜¯è£…æœ‰å®¢æˆ·æ“ä½œç³»ç»Ÿçš„ç£ç›˜ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯åŠ¨ä¸€å°è™šæ‹Ÿæœºæ—¶ï¼Œå®ƒçš„ç³»ç»Ÿç›˜è¡¨ç°ä¸º hypervisor æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªæ–‡ä»¶ï¼ˆé€šå¸¸ä½äº /var/lib/nova/instances/${uuid}/ï¼‰ï¼›</p>
</blockquote>
<p>å®‰è£…inié…ç½®å·¥å…·</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install crudini </span></span></code></pre></figure>
<p>åœ¨glance-apiçš„ä¸»æœºä¸Šå®‰è£…python-rbdåŒ…</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install python-rbd</span></span></code></pre></figure>
<p>åœ¨nova-computeï¼ˆæ‰€æœ‰è®¡ç®—èŠ‚ç‚¹ï¼‰ã€cinder-volumeèŠ‚ç‚¹ä¸Šå®‰è£…ceph-commonåŒ…</p>
<ul>
<li>åœ¨æ§åˆ¶èŠ‚ç‚¹è¿è¡Œå‘½ä»¤æ£€æŸ¥å¯¹åº”æœåŠ¡æ‰€åœ¨çš„èŠ‚ç‚¹</li>
</ul>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume service list</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+------------------+--------------+------+---------+-------+----------------------------+</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Binary</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">           |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Zone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Updated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> At                 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+------------------+--------------+------+---------+-------+----------------------------+</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cinder-scheduler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ctl01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nova</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 2023-12-19T08:03:42.000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cinder-volume</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cinder01@lvm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nova</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 2023-12-19T08:03:42.000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+------------------+--------------+------+---------+-------+----------------------------+</span></span></code></pre></figure>
<ul>
<li>åœ¨å¯¹åº”èŠ‚ç‚¹æ‰§è¡Œå®‰è£…</li>
</ul>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install ceph-common</span></span></code></pre></figure>
<p>æŠŠcephé›†ç¾¤çš„/etc/ceph/ceph.conf ã€/etc/ceph/ceph.client.admin.keyring æ–‡ä»¶æ‹·è´åˆ°ä»¥ä¸Šopenstackå„èŠ‚ç‚¹çš„/etc/cephç›®å½•ä¸‹ï¼Œç¡®ä¿ä»¥ä¸Šopenstackå„å¯¹åº”èŠ‚ç‚¹æˆä¸ºcephé›†ç¾¤çš„å®¢æˆ·ç«¯</p>
<p>åœ¨cephé›†ç¾¤åˆ›å»ºä¸‰ä¸ªpool ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šæ–‡ä¸‰ä¸ªæ¨¡å—ã€‚ä»¥åæ‰€æœ‰çš„OpenStackè™šæ‹Ÿæœºæ•°æ®éƒ½ä¼šå­˜å‚¨åˆ°è¿™ä¸‰ä¸ªæ± ä¸­ã€‚</p>
<p>åˆ›å»ºvolumesæ± ï¼Œå¯¹åº”CinderæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd pool create os_volumes </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span></code></pre></figure>
<p>åˆ›å»ºimagesæ± ï¼Œå¯¹åº”GlanceæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd pool create os_images </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span></code></pre></figure>
<p>åˆ›å»ºvmsæ± ï¼Œå¯¹åº”NovaæœåŠ¡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> osd pool create os_vms </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span></code></pre></figure>
<p>è®¾ç½®å­˜å‚¨æ± å‰¯æœ¬æ•°é‡</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph osd pool set os_vms size 1</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pool </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size to </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph osd pool set os_images size 1</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pool </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size to </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph osd pool set os_volumes size 2</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pool </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size to </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span></code></pre></figure>
<p>åœ¨cephé›†ç¾¤åˆ›å»ºcinderã€glanceç­‰ç”¨æˆ·ï¼Œå¹¶åšæƒé™æ§åˆ¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph auth get-or-create client.cinder mon </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'allow r'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> osd </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'allow class-read object_prefix rbd_children, allow rwx pool=os_volumes, allow rwx pool=os_vms, allow rx pool=os_images'</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[client.cinder]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        key</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = AQAMVYFl0ExWCxAAT632K3WB+5VtaXh3bp8DzA==</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@ceph01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ceph auth get-or-create client.glance mon </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'allow r'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> osd </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'allow class-read object_prefix rbd_children, allow rwx pool=os_images'</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[client.glance]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        key</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = AQAPVYFlceRZBBAA/V5Cg7SEC6TUZo543/H0tQ==</span></span>
<span data-line> </span></code></pre></figure>
<p>ï¼ˆåœ¨cephç«¯æ‰§è¡Œï¼‰å°†ä¸Šé¢ç”Ÿæˆçš„keyringæ–‡ä»¶ï¼Œä¿å­˜åœ¨glanceå’ŒvolumeèŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¿®æ”¹ä¸ºç›¸åº”çš„æƒé™</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auth get-or-create client.glance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ctl01 sudo tee /etc/ceph/ceph.client.glance.keyring</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ctl01 sudo chown glance:glance /etc/ceph/ceph.client.glance.keyring</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auth get-or-create client.cinder </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cinder01 sudo tee /etc/ceph/ceph.client.cinder.keyring</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cinder01 sudo chown cinder:cinder /etc/ceph/ceph.client.cinder.keyring</span></span></code></pre></figure>
<p>åœ¨nova-computeèŠ‚ç‚¹ï¼ˆæ‰€æœ‰è®¡ç®—èŠ‚ç‚¹ï¼‰ä¸Šä¿å­˜å’Œcinder-volumeç›¸åŒçš„keyring</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auth get-or-create client.cinder </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute01 sudo tee /etc/ceph/ceph.client.cinder.keyring</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute01 sudo chown nova:nova /etc/ceph/ceph.client.cinder.keyring</span></span></code></pre></figure>
<h4 id="compute-èŠ‚ç‚¹é…ç½®">compute èŠ‚ç‚¹é…ç½®<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#compute-èŠ‚ç‚¹é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>åœ¨openstacké›†ç¾¤æ‰€æœ‰computeèŠ‚ç‚¹libvirtä¸Šæ·»åŠ secret key</p>
<ul>
<li>ä»cephé›†ç¾¤è·å–cinder keyringï¼Œå¹¶ä¿å­˜åˆ°nova-comuteå¯¹åº”èŠ‚ç‚¹/rootç›®å½•ä¸‹ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­</li>
</ul>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ceph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auth get-key client.cinder </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compute01 tee client.cinder.key </span></span></code></pre></figure>
<blockquote>
<p>æ‰§è¡Œå®Œånova-computeèŠ‚ç‚¹çš„/rootä¸‹ä¼šå‡ºç°ä¸´æ—¶çš„æ–‡ä»¶</p>
</blockquote>
<ul>
<li>åœ¨computeèŠ‚ç‚¹ç”Ÿæˆä¸€ä¸ªUUID</li>
</ul>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uuidgen</span></span></code></pre></figure>
<p>æ¯”å¦‚ç”Ÿæˆï¼š912f054c-478b-44b7-bfc5-f0bbed491fbb</p>
<ul>
<li>/rootä¸‹touchä¸€ä¸ªæ–‡ä»¶ secret.xml å†…å®¹å¦‚ä¸‹ï¼š</li>
</ul>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="xml" data-theme="github-light github-dark"><code data-language="xml" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">secret</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ephemeral</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'no'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> private</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'no'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">>912f054c-478b-44b7-bfc5-f0bbed491fbb&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">usage</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'ceph'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">>client.cinder secret&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">usage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">></span></span></code></pre></figure>
<p>é€šè¿‡libvirtå·¥å…·ï¼ˆvirshï¼‰å®šä¹‰å’Œè®¾ç½®ç§˜é’¥ï¼Œå¹¶åœ¨è®¾ç½®ç§˜é’¥å€¼ååˆ é™¤ç›¸å…³çš„ç§˜é’¥å’ŒXMLæ–‡ä»¶</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@compute01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# virsh secret-define --file secret.xml</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Secret</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 912</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">f054c-478b-44b7-bfc5-f0bbed491fbb created</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@compute01 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# virsh secret-set-value --secret 912f054c-478b-44b7-bfc5-f0bbed491fbb --base64 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> client.cinder.key)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> client.cinder.key secret.xml</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Secret</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> value set</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove regular file â€˜client.cinder.keyâ€™? y</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove regular file â€˜secret.xmlâ€™? y</span></span></code></pre></figure>
<p>é…ç½®nova-computeèŠ‚ç‚¹/etc/nova/nova.confä¸­æ·»åŠ å¦‚ä¸‹ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="ini" data-theme="github-light github-dark"><code data-language="ini" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[libvirt]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">images_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = rbd</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">images_rbd_pool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = os_vms</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">images_rbd_ceph_conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = /etc/ceph/ceph.conf</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rbd_user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = cinder</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rbd_secret_uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = 912f054c-478b-44b7-bfc5-f0bbed491fbb</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">disk_cachemodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;network=writeback&quot;</span></span></code></pre></figure>
<p>å¯¹åº”èŠ‚ç‚¹é‡å¯æœåŠ¡ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-nova-compute </span></span></code></pre></figure>
<h4 id="glance-èŠ‚ç‚¹é…ç½®">glance èŠ‚ç‚¹é…ç½®<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#glance-èŠ‚ç‚¹é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>é…ç½®glanceèŠ‚ç‚¹/etc/glance/glance-api.confå¯¹æ¥ceph</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf DEFAULT &quot;show_image_direct_url&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;True&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store &quot;default_store&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;rbd&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store &quot;rbd_store_user&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;glance&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store &quot;rbd_store_pool&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;os_images&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store &quot;stores&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;glance.store.filesystem.Store, glance.store.http.Store, glance.store.rbd.Store&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf paste_deploy &quot;flavor&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;keystone&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store &quot;rbd_store_chunk_size&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;8&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/glance/glance-api.conf glance_store &quot;rbd_store_ceph_conf&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ceph/ceph.conf&quot;</span></span></code></pre></figure>
<p>åœ¨DEFAULTåŸŸä¸­å¢åŠ ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="ini" data-theme="github-light github-dark"><code data-language="ini" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[DEFAULT]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">default_store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = rbd</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é»˜è®¤æ˜¯fileï¼Œè¦ä¿®æ”¹</span></span></code></pre></figure>
<p>åœ¨glance_storeåŸŸä¸­å¢åŠ å¦‚ä¸‹ï¼Œå¦‚æœæ²¡æœ‰glance_storeåŸŸï¼Œç›´æ¥åˆ›å»ºï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="ini" data-theme="github-light github-dark"><code data-language="ini" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[glance_store]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">stores</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = rbd</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rbd_store_pool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = os_images</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rbd_store_user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = glance</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rbd_store_ceph_conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = /etc/ceph/ceph.conf</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rbd_store_chunk_size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = 8</span></span></code></pre></figure>
<p>å¯¹åº”èŠ‚ç‚¹é‡å¯æœåŠ¡ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-glance-api </span></span></code></pre></figure>
<h4 id="cinder-èŠ‚ç‚¹é…ç½®">cinder èŠ‚ç‚¹é…ç½®<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cinder-èŠ‚ç‚¹é…ç½®" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>é…ç½®cinderèŠ‚ç‚¹çš„/etc/cinder/cinder.confå¯¹æ¥ceph</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf DEFAULT &quot;enabled_backends&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;lvm,ceph&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # åŒæ—¶æ”¯æŒlvmã€ceph</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;volume_driver&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cinder.volume.drivers.rbd.RBDDriver&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;volume_backend_name&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ceph&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_pool&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;os_volumes&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_ceph_conf&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ceph/ceph.conf&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_flatten_volume_from_snapshot&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;false&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_max_clone_depth&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;5&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_store_chunk_size&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;4&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rados_connect_timeout&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;-1&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;glance_api_version&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;2&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_user&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cinder&quot;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crudini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/cinder/cinder.conf ceph &quot;rbd_secret_uuid&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;912f054c-478b-44b7-bfc5-f0bbed491fbb&quot;</span></span></code></pre></figure>
<p>å¯¹åº”èŠ‚ç‚¹é‡å¯æœåŠ¡ï¼š</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart openstack-cinder-volume </span></span></code></pre></figure>
<h4 id="éªŒè¯-2">éªŒè¯<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#éªŒè¯-2" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>openstackçš„dashboardä¸­æµ‹è¯•åˆ›å»ºå·ã€ç”Ÿæˆé•œåƒå’Œå·ç”Ÿæˆè™šæ‹Ÿæœºç­‰æ“ä½œ</p>
<p>æŸ¥çœ‹ volume service</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume service list</span></span></code></pre></figure>
<p>åˆ›å»º volume type</p>
<figure data-rehype-pretty-code-figure><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" data-language="sh" data-theme="github-light github-dark"><code data-language="sh" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openstack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume type create lvm</span></span></code></pre></figure></article></div><div class="right sidebar"><div class="graph"><h3>å…³ç³»å›¾è°±</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>ç›®å½•</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-1"><a href="#åŸºç¡€ç¯å¢ƒå‡†å¤‡" data-for="åŸºç¡€ç¯å¢ƒå‡†å¤‡">åŸºç¡€ç¯å¢ƒå‡†å¤‡</a></li><li class="depth-2"><a href="#èŠ‚ç‚¹è§„åˆ’" data-for="èŠ‚ç‚¹è§„åˆ’">èŠ‚ç‚¹è§„åˆ’</a></li><li class="depth-2"><a href="#ç³»ç»Ÿç‰ˆæœ¬" data-for="ç³»ç»Ÿç‰ˆæœ¬">ç³»ç»Ÿç‰ˆæœ¬</a></li><li class="depth-2"><a href="#è‡ªåŠ¨è¡¥å…¨" data-for="è‡ªåŠ¨è¡¥å…¨">è‡ªåŠ¨è¡¥å…¨</a></li><li class="depth-2"><a href="#ä¸‹è½½åŒ…åˆ°æœ¬åœ°" data-for="ä¸‹è½½åŒ…åˆ°æœ¬åœ°">ä¸‹è½½åŒ…åˆ°æœ¬åœ°</a></li><li class="depth-2"><a href="#é…ç½®æœ¬åœ°yum" data-for="é…ç½®æœ¬åœ°yum">é…ç½®æœ¬åœ°YUM</a></li><li class="depth-2"><a href="#åŸºç¡€å·¥å…·å®‰è£…" data-for="åŸºç¡€å·¥å…·å®‰è£…">åŸºç¡€å·¥å…·å®‰è£…</a></li><li class="depth-2"><a href="#æ›´æ”¹ä¸»æœºå" data-for="æ›´æ”¹ä¸»æœºå">æ›´æ”¹ä¸»æœºå</a></li><li class="depth-2"><a href="#é…ç½®ç½‘ç»œ" data-for="é…ç½®ç½‘ç»œ">é…ç½®ç½‘ç»œ</a></li><li class="depth-2"><a href="#å…³é—­selinux" data-for="å…³é—­selinux">å…³é—­selinux</a></li><li class="depth-2"><a href="#è¿æ¥æ•°é…ç½®" data-for="è¿æ¥æ•°é…ç½®">è¿æ¥æ•°é…ç½®</a></li><li class="depth-2"><a href="#å…³é—­é˜²ç«å¢™" data-for="å…³é—­é˜²ç«å¢™">å…³é—­é˜²ç«å¢™</a></li><li class="depth-2"><a href="#å…³é—­networkmanager" data-for="å…³é—­networkmanager">å…³é—­NetworkManager</a></li><li class="depth-2"><a href="#hostsæ–‡ä»¶é…ç½®" data-for="hostsæ–‡ä»¶é…ç½®">HOSTSæ–‡ä»¶é…ç½®</a></li><li class="depth-2"><a href="#ntpæ—¶é’ŸåŒæ­¥" data-for="ntpæ—¶é’ŸåŒæ­¥">NTPæ—¶é’ŸåŒæ­¥</a></li><li class="depth-1"><a href="#æ•°æ®åº“" data-for="æ•°æ®åº“">æ•°æ®åº“</a></li><li class="depth-1"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" data-for="æ¶ˆæ¯é˜Ÿåˆ—">æ¶ˆæ¯é˜Ÿåˆ—</a></li><li class="depth-1"><a href="#memcached" data-for="memcached">Memcached</a></li><li class="depth-1"><a href="#etcd" data-for="etcd">Etcd</a></li><li class="depth-1"><a href="#å¯†ç è§„åˆ’" data-for="å¯†ç è§„åˆ’">å¯†ç è§„åˆ’</a></li><li class="depth-1"><a href="#minimal-deployment-for-train" data-for="minimal-deployment-for-train">Minimal deployment for Train</a></li><li class="depth-2"><a href="#keystone" data-for="keystone">Keystone</a></li><li class="depth-2"><a href="#glance" data-for="glance">Glance</a></li><li class="depth-2"><a href="#placement" data-for="placement">Placement</a></li><li class="depth-2"><a href="#nova" data-for="nova">Nova</a></li><li class="depth-2"><a href="#neutron" data-for="neutron">Neutron</a></li><li class="depth-2"><a href="#horizon" data-for="horizon">Horizon</a></li><li class="depth-2"><a href="#cinder" data-for="cinder">Cinder</a></li><li class="depth-0"><a href="#openstackä½¿ç”¨" data-for="openstackä½¿ç”¨">Openstackä½¿ç”¨</a></li><li class="depth-1"><a href="#å»ºç«‹å…¬å…±æä¾›å•†ç½‘ç»œ" data-for="å»ºç«‹å…¬å…±æä¾›å•†ç½‘ç»œ">å»ºç«‹å…¬å…±æä¾›å•†ç½‘ç»œ</a></li><li class="depth-2"><a href="#åˆ›å»ºç½‘ç»œ" data-for="åˆ›å»ºç½‘ç»œ">åˆ›å»ºç½‘ç»œ</a></li><li class="depth-2"><a href="#åˆ›å»ºå­ç½‘" data-for="åˆ›å»ºå­ç½‘">åˆ›å»ºå­ç½‘</a></li><li class="depth-1"><a href="#å»ºç«‹æ™®é€šç§Ÿæˆ·çš„ç§æœ‰è‡ªåŠ©æœåŠ¡ç½‘ç»œ" data-for="å»ºç«‹æ™®é€šç§Ÿæˆ·çš„ç§æœ‰è‡ªåŠ©æœåŠ¡ç½‘ç»œ">å»ºç«‹æ™®é€šç§Ÿæˆ·çš„ç§æœ‰è‡ªåŠ©æœåŠ¡ç½‘ç»œ</a></li><li class="depth-2"><a href="#åˆ›å»ºç½‘ç»œ-1" data-for="åˆ›å»ºç½‘ç»œ-1">åˆ›å»ºç½‘ç»œ</a></li><li class="depth-2"><a href="#åˆ›å»ºå­ç½‘-1" data-for="åˆ›å»ºå­ç½‘-1">åˆ›å»ºå­ç½‘</a></li><li class="depth-2"><a href="#åˆ›å»ºè·¯ç”±" data-for="åˆ›å»ºè·¯ç”±">åˆ›å»ºè·¯ç”±</a></li><li class="depth-2"><a href="#ip-nets" data-for="ip-nets">Ip nets</a></li><li class="depth-0"><a href="#cephå®‰è£…" data-for="cephå®‰è£…">Cephå®‰è£…</a></li><li class="depth-2"><a href="#dashboardé…ç½®" data-for="dashboardé…ç½®">Dashboardé…ç½®</a></li><li class="depth-2"><a href="#cephå¸¸ç”¨å‘½ä»¤" data-for="cephå¸¸ç”¨å‘½ä»¤">Cephå¸¸ç”¨å‘½ä»¤</a></li><li class="depth-2"><a href="#å¸¸è§å‘Šè­¦å¤„ç†" data-for="å¸¸è§å‘Šè­¦å¤„ç†">å¸¸è§å‘Šè­¦å¤„ç†</a></li><li class="depth-2"><a href="#å¯¹æ¥openstack" data-for="å¯¹æ¥openstack">å¯¹æ¥OpenStack</a></li></ul></div></div><div class="backlinks"><h3>åå‘é“¾æ¥</h3><ul class="overflow"><li>æ— æ³•æ‰¾åˆ°åå‘é“¾æ¥</li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.2.2</a> Â© 2024</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></body><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="../postscript.js" type="module"></script></html>